
\documentclass[12pt,a4paper]{article}

\setlength{\topmargin}{-2cm} \setlength{\topskip}{0cm}
\setlength{\headheight}{1.5cm} \setlength{\headsep}{1cm}
\setlength{\textheight}{24.5cm} \setlength{\oddsidemargin}{.25cm}
\setlength{\evensidemargin}{.25cm} \setlength{\textwidth}{17cm}
%\setcounter{tocdepth}{1}
\setlength{\unitlength}{1cm}
%\input /home3/st/st1jeo/tex/epsf.tex

\input{../epsf.tex}
\newcommand{\balpha}{\mbox{\boldmath{$\alpha$}}\unboldmath}
\newcommand{\bn}{\mbox{$\mathbf{n}$}}
\newcommand{\ba}{\mbox{$\mathbf{a}$}}
\newcommand{\bx}{\mbox{$\mathbf{x}$}}
\newcommand{\xvec}{\mbox{$\bx_1,\ldots,\bx_n$}}
\newcommand{\yxvec}{\mbox{$y_1=\eta(\bx_1),\ldots,y_n=\eta(\bx_n)$}}
\newcommand{\by}{\mbox{$\mathbf{y}$}}
\newcommand{\boldm}{\mbox{$\mathbf{m}$}}
\newcommand{\bh}{\mbox{$\mathbf{h}$}}
\newcommand{\bt}{\mbox{$\mathbf{t}$}}
\newcommand{\bbeta}{\mbox{\boldmath{$\beta$}}\unboldmath}
\newcommand{\bdelta}{\mbox{\boldmath{$\delta$}}\unboldmath}
\newcommand{\btheta}{\mbox{\boldmath{$\theta$}}\unboldmath}
\newcommand{\bo}[1]{\mbox{$\mathbf{#1}$}}
\newcommand{\yxpvec}{\mbox{$y_1'=\eta(\bx_1'),\ldots,y_{n'}'=\eta(\bx_{n'}')$}}
\newcommand{\xpvec}{\mbox{$\bx_1',\ldots,\bx_{n'}'$}}
\newcommand{\ri}{\mbox{$^{131}I$} }
\newcommand{\bX}{\bo{X}}
\newcommand{\bY}{\bo{Y}}
\newcommand{\betahat}{\mbox{$\hat{\bbeta}$}}
\newcommand{\sighat}{\mbox{$\hat{\sigma} ^2$}}
\newcommand{\gap}{ \\ \\ \\ \\ \\ }
\newcommand{\vect}[1]{\mbox{{\boldmath $#1$}}}
\renewcommand{\baselinestretch}{1.25}
% Standardized forms for name of S-plus
\renewcommand{\S}{R}
\newcommand{\Shead}{R}

\pagestyle{myheadings} \markboth{Programming exercises 1}{Programming exercises 1}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage{graphicx}
\newtheorem{definition}{Definition}

\graphicspath{ {../Graphs/} }
\begin{document}
\section{Programming exercises}

In this section we will primarily be working through examples similar to those in
the lecture notes. We will use R to perform the computation required. I highly recommend that you use Rstudio.

%First get the R workspace \verb"MAS472.RData" from MOLE, and load it
%into R. This contains data for questions 3 and 6, and example
%solutions for question 1.
\begin{enumerate}
\item 

Suppose $X_1, \ldots, X_{10}$ are iid $U[0,1]$ random variables. Find the distribution of 
$$R(X) = \max_i\{X_i\} - \min_i \{X_i\}.$$
What is $\mathbb{P}(R(X) > 0.99)$?

If you are struggling, note that the code from the problems discussed in lectures is available on MOLE.


\item Estimate the integral 
$$I = \int_{0}^{10}\frac{1}{(1+x^2)} dx$$ 
using at least two different choices for the proposal density  $g(\cdot)$.

Find a 95\% confidence interval for your estimate using the central limit theorem.

%Note that you can check your confidence inis appropriate by generating 1000 different estimates of I, and checking that the o


\item Suppose $X_1, \ldots, X_{10}\ sim N(\mu, \sigma^2)$, and that we observe data
$$\{2.561, -0.328,  2.607,  3.466,  2.012,  1.293, -2.301,  1.914,  5.779,  1.369\}$$


\begin{itemize}
 \item Assume that $\sigma=2$. Use a Monte Carlo test to  test the null hypothesis
 $$H_0: \mu = 1$$
 against the alternative 
 $$ H_1: \mu \neq 1.$$

 \item Now assume that $\mu =1 $. Use a Monte Carlo test to test the null hypothesis
 $$H_0: \sigma^2 = 1$$
 against the alternative 
 $$ H_1: \sigma^2 > 1.$$
 %It may help you to recall that
 
\end{itemize}


Use a Monte Carlo test procedure to test the hypothesis
$H_0:\sigma^2=1$, given data


\item We will now consider the example from the lecture notes in which we  test for randomness in spatial patterns.\\

Download the data from R, and load the data using the command

{\tt
load(Class1data.Rdata)
}

Locations of 50 points are stored in the vector \verb"spatial". Check that you can plot the data with the command

{\tt 
plot(spatial)
}

Use a
Monte Carlo test to test the null
hypothesis that the distribution of points is uniform over the unit square\\

Hint: The hardest part to this problem is computing the nearest
neighbour distances for any particular pattern of points. If you are
unable to write your own function to do this, a function is given at
the end of this section, and is stored in the \verb"MAS472.RData"
workspace under the name \verb"nnsum".


\end{enumerate}

\end{document}