<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Richard Wilkinson">

<title>Week 7 - Convex optimization: exercise solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="Week7-convexopt_files/libs/clipboard/clipboard.min.js"></script>
<script src="Week7-convexopt_files/libs/quarto-html/quarto.js"></script>
<script src="Week7-convexopt_files/libs/quarto-html/popper.min.js"></script>
<script src="Week7-convexopt_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Week7-convexopt_files/libs/quarto-html/anchor.min.js"></script>
<link href="Week7-convexopt_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Week7-convexopt_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Week7-convexopt_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Week7-convexopt_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Week7-convexopt_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Week 7 - Convex optimization: exercise solutions</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Prof.&nbsp;Richard Wilkinson </p>
            </div>
    </div>
      
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#question-0" id="toc-question-0" class="nav-link active" data-scroll-target="#question-0">Question 0</a></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question 7</a></li>
  <li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question 8</a></li>
  <li><a href="#question-9" id="toc-question-9" class="nav-link" data-scroll-target="#question-9">Question 9</a></li>
  <li><a href="#question-10" id="toc-question-10" class="nav-link" data-scroll-target="#question-10">Question 10</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="hidden">

</div>
<section id="question-0" class="level2">
<h2 class="anchored" data-anchor-id="question-0">Question 0</h2>
<p>Let <span class="math inline">\(g: S \rightarrow \mathbb{R}\)</span> be a function defined over <span class="math inline">\(S\subseteq \mathbb{R}^n\)</span>. The <strong>level set</strong> of <span class="math inline">\(g\)</span> with level <span class="math inline">\(a\)</span>, is <span class="math display">\[\operatorname{Lev}(g,a)=\{\mathbf{x}: g(\mathbf{x})\leq a\}.\]</span></p>
<p>Show that the level sets of convex functions are convex.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose <span class="math inline">\(\mathbf{x}, {\mathbf{y}}\in \operatorname{Lev}(g,a)\)</span> and <span class="math inline">\(\lambda \in [0,1]\)</span>. Then <span class="math display">\[g(\lambda\mathbf{x}+(1-\lambda){\mathbf{y}})\leq \lambda g(\mathbf{x})+(1-\lambda)g({\mathbf{y}})\leq a\]</span> as <span class="math inline">\(g\)</span> is convex. Thus <span class="math inline">\(\lambda\mathbf{x}+(1-\lambda){\mathbf{y}}\in \operatorname{Lev}(g,a)\)</span> and so <span class="math inline">\(\operatorname{Lev}(g,a)\)</span> is convex.</p>
</div>
</div>
</div>
</section>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Consider the functional form for optimization problems: <span class="math display">\[\begin{align*}
    \begin{array}{ll}
        \min &amp; f(\mathbf{x}) \\
        \text { s.t. } &amp; g_{i}(\mathbf{x}) \leq 0, \quad i=1,2, \ldots, m \\
        &amp; h_{j}(\mathbf{x})=0, \quad j=1,2, \ldots, p\,,
    \end{array}
\end{align*}\]</span> where <span class="math inline">\(f, g_{1}, \ldots, g_{m}: \mathbb{R}^{n} \rightarrow \mathbb{R}\)</span> are convex functions, and <span class="math inline">\(h_{1}, h_{2}, \ldots, h_{p}: \mathbb{R}^{m} \rightarrow \mathbb{R}\)</span> are affine functions.</p>
<p>Show that this functional form of the problem does fit into the general formulation (CVX), i.e., show that <span class="math display">\[C=\{\mathbf{x}: g_i(\mathbf{x}) \leq 0, h_j(\mathbf{x})=0\}\]</span> is a convex set.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <span class="math inline">\(h_j\)</span> are affine, and so we can write them as <span class="math inline">\(h_j(\mathbf{x})=\mathbf{A}_j\mathbf{x}+\mathbf{b}_j\)</span>. Thus <span class="math inline">\(C_j=\{\mathbf{x}: h_j(\mathbf{x})=0\}=\{\mathbf{x}: \mathbf{A}_j\mathbf{x}=\mathbf{b}_j\}.\)</span> We saw last week that sets of this form are convex.</p>
<p>Now consider the sets <span class="math inline">\(D_i=\operatorname{Lev}(g_i,0)=\{\mathbf{x}: g_i(\mathbf{x})\leq 0\}\)</span>. By the previous question, we know these are convex.</p>
<p>Finally, note that the feasible set for this problem is <span class="math display">\[\left(\bigcap_{i=1}^m C_i \right)\cap \left(\bigcap_{j=1}^p D_j\right)\]</span> and this is convex as we know the intersection of convex sets is convex. This is thus a convex optimization problem of the form (CVX).</p>
</div>
</div>
</div>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>Prove that for convex optimization problems <span class="math inline">\(\min \{f(\mathbf{x}): \mathbf{x} \in C\}\)</span> where <span class="math inline">\(f\)</span> and <span class="math inline">\(C\)</span> are convex, the set of optimal solutions is also convex. In addition, prove that if <span class="math inline">\(f\)</span> is strictly convex over <span class="math inline">\(C\)</span>, then there exists at most one optimal solution of the problem.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(f^* = \min \{f(\mathbf{x}): \mathbf{x} \in C\}\)</span> and let <span class="math display">\[M = \{\mathbf{x}\in C: f(\mathbf{x})=f^*\}\]</span> be the set of optimal solutions. Suppose <span class="math inline">\(\mathbf{x}, {\mathbf{y}}\in M\)</span> and <span class="math inline">\(\lambda \in [0,1]\)</span>. Because <span class="math inline">\(C\)</span> is convex we know <span class="math inline">\(\lambda\mathbf{x}+(1-\lambda){\mathbf{y}}\in C\)</span>. Then <span class="math display">\[f(\lambda\mathbf{x}+(1-\lambda){\mathbf{y}})\leq \lambda f(\mathbf{x})+(1-\lambda)f({\mathbf{y}}) =  \lambda f^*+(1-\lambda)f^*=f^*.\]</span> as <span class="math inline">\(f\)</span> is convex. Hence we must have <span class="math inline">\(\lambda\mathbf{x}+(1-\lambda){\mathbf{y}}\in M\)</span> and so <span class="math inline">\(M\)</span> is convex.</p>
<p>If <span class="math inline">\(f\)</span> is strictly convex, then</p>
<p><span class="math display">\[f(\lambda\mathbf{x}+(1-\lambda){\mathbf{y}})&lt; \lambda f(\mathbf{x})+(1-\lambda)f({\mathbf{y}}) =f^*\]</span> which is a contradiction, as <span class="math inline">\(f^*\)</span> is the minimum value of <span class="math inline">\(f\)</span>. So <span class="math inline">\(C\)</span> must contain at most one value.</p>
</div>
</div>
</div>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Show that <span class="math display">\[\begin{align*}
    \begin{array}{ll}
        \min &amp; -2 x_{1}+x_{2} \\
        \text { s.t. } &amp; x_{1}^{2}+x_{2}^{2} \leq 3
    \end{array}
\end{align*}\]</span> is a convex optimization problem. Show that <span class="math display">\[\begin{align*}
    \begin{array}{ll}
        \min &amp; x_{1}^{2}-x_{2} \\
        \text { s.t. } &amp;  x_{1}^{2}+x_{2}^{2}=3
    \end{array}
\end{align*}\]</span> is a non-convex problem.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the first problem, the objective <span class="math inline">\(-2 x_{1}+x_{2}\)</span> is linear, and hence convex. The constraint is a level set of <span class="math inline">\(g\)</span>, i.e., of the form <span class="math inline">\(\{\mathbf{x}: g(\mathbf{x})\leq 3\}\)</span> where <span class="math inline">\(g(\mathbf{x})=x_1^2+x_2^2\)</span>. <span class="math inline">\(g\)</span> is a convex function (e.g.&nbsp;check the Hessian), and so this problem is asking us to minimize a convex function over a convex set, and hence is a convex optimization problem.</p>
<p>In the second problem, the objective function is convex, but the feasible set is not convex (draw it - it is the boundary of a circle of radius <span class="math inline">\(\sqrt{3}\)</span>). So this is not a convex optimization problem.</p>
</div>
</div>
</div>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p><strong>Maximization of convex functions:</strong> Find the maximum of the following convex maximization problems:</p>
<ol type="1">
<li><span class="math display">\[\max \{\mathbf{x}^\top\mathbf{Q}\mathbf{x}: ||\mathbf{x}||_\infty\leq 1\}\]</span> where <span class="math inline">\(\mathbf{Q}\succeq 0\)</span>.</li>
<li><span class="math display">\[\max \{\ ||\mathbf{A}\mathbf{x}||_1 : ||\mathbf{x}||_1\leq 1\}\]</span> where <span class="math inline">\(\mathbf{A}\in \mathbb{R}^{m\times n}.\)</span></li>
</ol>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>The objective <span class="math inline">\(f(\mathbf{x})=\mathbf{x}^\top\mathbf{Q}\mathbf{x}\)</span> is a convex function as <span class="math inline">\(\mathbf{Q}\)</span> is positive definite. The feasible set <span class="math inline">\(C=\{\mathbf{x}: \|\mathbf{x}\|_\infty \leq 1\}\)</span> is convex and compact (bounded and closed). Thus by a theorem from lectures we know that there is a maximizer that is an extreme point of <span class="math inline">\(C\)</span>. The extreme points are of the form <span class="math inline">\(\{-1, 1\}^n\)</span>, i.e., points where each component is either <span class="math inline">\(-1\)</span> or <span class="math inline">\(1\)</span>.</p></li>
<li><p>The objective function <span class="math inline">\(\|\mathbf{A}\mathbf{x}\|_1\)</span> is the composition of a norm function (which is convex) with a linear function, and hence is convex. The feasible set is compact and convex. Hence, again we must have that there is a maximizer that is an extreme point. The extreme points of the <span class="math inline">\(\ell_1\)</span> unit ball are <span class="math inline">\(\pm\mathbf{e}_1, \ldots, \pm\mathbf{e}_n\)</span>.</p>
<p><span class="math display">\[\|\mathbf{A}\mathbf{e}_j\|_1 =\|-\mathbf{A}\mathbf{e}_j\|_1 = \sum_{i=1}^m |A_{i,j}|\]</span> and thus we have that <span class="math display">\[\max \{\ ||\mathbf{A}\mathbf{x}||_1 : ||\mathbf{x}||_1\leq 1\}\max_{j=1,\ldots, n}\sum_{i=1}^m |A_{i,j}|\]</span></p>
<p>Note that this is sometimes call the induced 1,1-norm for matrices, and denoted <span class="math inline">\(\|\mathbf{A}\|_{1,1}\)</span></p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Solve <span class="math display">\[\begin{align*}
\begin{array}{ll}
\max_{\mathbf{x}}&amp; 2x_1+3x_2-x_3\\
\mbox{ such that} &amp; \begin{aligned}
        x_{1}+x_{2}+x_{3} &amp;=6 \\
        x_{2}+x_{4} &amp;=3 \\
        x_{1}, x_{2}, x_{3}, x_{4} &amp; \geq 0
    \end{aligned}
    \end{array}
\end{align*}\]</span> What is the minimum of this problem?</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The objective is convex as are the constraints, and so we know that the max must occur at an extreme point. Notice that the feasible set is a convex polytope of the form</p>
<p><span class="math display">\[ \begin{pmatrix}1&amp;1&amp;1&amp;0\\
0&amp;1&amp;0&amp;1\end{pmatrix}\mathbf{x}= \begin{pmatrix} 6\\3\end{pmatrix} \mbox{ with }\mathbf{x}\geq \mathbf{0}.
\]</span> We found the basic feasible solutions of the system in last week’s exercises. They are</p>
<p><span class="math display">\[\begin{pmatrix}3\\3\\0\\0\end{pmatrix},
\begin{pmatrix}6\\0\\0\\3\end{pmatrix},
\begin{pmatrix}0\\3\\3\\0\end{pmatrix},
\begin{pmatrix}0\\0\\6\\3\end{pmatrix}. \]</span></p>
<p>We just need to evaluate the objective at each point in turn and then pick the largest. So in this case we can see that the max is 12 achieved at <span class="math inline">\(\begin{pmatrix}6\\0\\0\\3\end{pmatrix}\)</span>.</p>
<p>We’ve said that the maximum of a convex function over a convex set must be at an extreme point (which are the BFS when the feasible set is a convex polytope). But for linear programmes, the objective is linear. Minimizing a linear function is the same as maximizing the negative of it, which is still convex. And so the minimum must also be achieved at an extreme point.</p>
<p>Checking each solution, we see the minimum is -6 achieved at <span class="math inline">\(\begin{pmatrix}0\\0\\6\\3\end{pmatrix}\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="question-7" class="level2">
<h2 class="anchored" data-anchor-id="question-7">Question 7</h2>
<p>Solve <span class="math display">\[\begin{align*}
\begin{array}{ll}
\min_{\mathbf{x}}&amp; x_1+x_2\\
\mbox{ such that} &amp; \begin{aligned}
        2x_{1}+x_{2}\leq 2 \\
        x_{2}+x_{3} \leq 3 \\
        x_{1}, x_{2}, x_{3}&amp; \geq 0
    \end{aligned}
    \end{array}
\end{align*}\]</span> <strong>Hint:</strong> you can introduce new variables <span class="math inline">\(x_4, x_5\geq 0\)</span> to convert the inequality constraints into equality constraints.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Firstly, note that in this case we can wee instantly that the minimum will be 0. But let’s work through our method of first finding the basic feasible solutions.</p>
<p>Firstly, let’s convert it to the type of problem we’ve seen before with equality constraints. Convince yourself that the problem is equivalent to this problem with 5 variables:</p>
<p><span class="math display">\[\begin{align*}
\begin{array}{ll}
\min_{\mathbf{x}}&amp; x_1+x_2\\
\mbox{ such that} &amp; \begin{aligned}
        2x_{1}+x_{2}+x_4= 2 \\
        x_{2}+x_{3} +x_5= 3 \\
        x_{1}, x_{2}, x_{3}, x_4, x_5&amp; \geq 0
    \end{aligned}
    \end{array}
\end{align*}\]</span></p>
<p>The constraints can be written as <span class="math display">\[ \begin{pmatrix}2&amp;1&amp;0&amp;1&amp;0\\
0&amp;1&amp;1&amp;0&amp;1\end{pmatrix}\mathbf{x}= \begin{pmatrix} 2\\3\end{pmatrix} \mbox{ with }\mathbf{x}\geq \mathbf{0}.
\]</span> which is a convex polytope.</p>
<p>Let’s again find the basic feasible solutions, as we know these are the same as the extreme points, and that the min will be achieve by at least one extreme point. A BFS can have at most two non-zero entries.</p>
<p>Cycling through the options of which variables could be non-zero, we see the candidates are</p>
<p><span class="math display">\[\begin{pmatrix}-\frac{1}{2}\\3\\0\\0\\0\end{pmatrix},\quad
\begin{pmatrix}-\frac{1}{2}\\0\\3\\0\\0\end{pmatrix},\quad
\begin{pmatrix}1\\0\\0\\0\\3\end{pmatrix},\quad
\begin{pmatrix}0\\2\\1\\0\\0\end{pmatrix},\quad
\begin{pmatrix}0\\3\\0\\-1\\0\end{pmatrix},\quad
\begin{pmatrix}0\\2\\0\\0\\1\end{pmatrix},\quad
\begin{pmatrix}0\\0\\3\\2\\0\end{pmatrix},\quad
\begin{pmatrix}0\\0\\0\\2\\3\end{pmatrix}.
\]</span> We can rule out 3 of these as they have negative components. For the 5 remaining points, we can evaluate the objective and see that the minimum is <span class="math inline">\(0\)</span> achieved at</p>
<p><span class="math display">\[\begin{pmatrix}0\\0\\3\\2\\0\end{pmatrix},\;
\mbox{ and} \;\begin{pmatrix}0\\0\\0\\2\\3\end{pmatrix}.
\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-8" class="level2">
<h2 class="anchored" data-anchor-id="question-8">Question 8</h2>
<p>Consider the convex optimization problem <span class="math display">\[\min
\{f(\mathbf{x}) : \mathbf{e}^\top \mathbf{x}=1\}\]</span> where <span class="math inline">\(f\)</span> is a convex function. Show that the stationarity condition for this problem is equivalent to <span class="math display">\[ \frac{\partial f}{\partial x_{1}}\left(\mathbf{x}^{*}\right)=\ldots=\frac{\partial f}{\partial x_{n}}\left(\mathbf{x}^{*}\right) \]</span></p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose <span class="math inline">\(\mathbf{x}^*\)</span> is a stationary point. Then by definition <span class="math display">\[\nabla f(\mathbf{x}^*)^\top (\mathbf{x}-\mathbf{x}^*)\geq 0 \mbox{ for all } \mathbf{x}\in C\]</span> where <span class="math inline">\(C=\{\mathbf{x}: \mathbf{x}^\top \mathbf{e}=1\}\)</span> is the feasible set. We want to show this is equivalent to the condition given in the question.</p>
<p>Let’s first show that the condition implies stationarity. Assume the condition is true. Then we have that <span class="math display">\[\nabla f(\mathbf{x}^*)^\top (\mathbf{x}-\mathbf{x}^*) = \sum_i \frac{\partial f}{\partial x_i}(\mathbf{x}^*)(x_i-x_i^*) = \frac{\partial f}{\partial x_1}(\mathbf{x}^*)\sum_i (x_i-x_i^*)=
\frac{\partial f}{\partial x_1}(\mathbf{x}^*)(1-1)=0\]</span> for <span class="math inline">\(\mathbf{x}\in C\)</span>. Thus <span class="math inline">\(\mathbf{x}^*\)</span> is stationary. Here the second equality follows from the condition, and the third from the definition of the feasible set.</p>
<p>Now let’s prove the converse, namely that if <span class="math inline">\(\mathbf{x}^*\)</span> is stationary then the condition holds. Assume that <span class="math inline">\(\mathbf{x}^*\)</span> is stationary, but that the condition is false. I.e., that there exists <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math display">\[\frac{\partial f}{\partial x_i}(\mathbf{x}^*)&gt; \frac{\partial f}{\partial x_j}(\mathbf{x}^*).\]</span> Consider the vector <span class="math inline">\(\mathbf{x}\)</span> with components <span class="math display">\[x_k = \begin{cases}
x_k^* &amp;\mbox{ if } k \not \in \{i,j\}\\
x_i^*-1&amp;\mbox{ if } k=i\\
x_j^*+1&amp;\mbox{ if } k=j.
\end{cases}\]</span> Note that <span class="math inline">\(\mathbf{x}\in C\)</span>. We have that<br>
<span class="math display">\[
\nabla f(\mathbf{x}^*)^\top (\mathbf{x}-\mathbf{x}^*) =-\frac{\partial f}{\partial x_i}(\mathbf{x}^*)+\frac{\partial f}{\partial x_j}(\mathbf{x}^*)&lt;0.
\]</span> This contradicts the stationarity condition. Thus we must have that the condition is true.</p>
</div>
</div>
</div>
</section>
<section id="question-9" class="level2">
<h2 class="anchored" data-anchor-id="question-9">Question 9</h2>
<p>Let <span class="math inline">\(C\)</span> be a closed and convex set. Prove that the distance function from the set <span class="math inline">\(d_{C}(\mathbf{x}) \equiv \inf _{\mathbf{y} \in C}\|\mathbf{x}-\mathbf{y}\|\)</span> is a convex function.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2\in C\)</span> and <span class="math inline">\(\lambda \in [0,1]\)</span>. Because <span class="math inline">\(C\)</span> is closed, there exist <span class="math inline">\({\mathbf{y}}_1\)</span> and <span class="math inline">\({\mathbf{y}}_2\)</span> such that <span class="math display">\[||\mathbf{x}_1-{\mathbf{y}}_1||=d_C(\mathbf{x}_1)\quad\mbox{and}\quad ||\mathbf{x}_2-{\mathbf{y}}_2||=d_C(\mathbf{x}_2).\]</span> Because <span class="math inline">\(C\)</span> is convex, we know that <span class="math inline">\(\mathbf{z}= \lambda{\mathbf{y}}_1 +(1-\lambda){\mathbf{y}}_2 \in C\)</span>. Thus <span class="math display">\[\begin{align*}
d_C(\lambda\mathbf{x}_1+(1-\lambda)\mathbf{x}_2) &amp;= \inf_{\mathbf{y}}\|\lambda \mathbf{x}_1+(1-\lambda)\mathbf{x}_2-{\mathbf{y}}\|\\
&amp;\leq \|\lambda \mathbf{x}_1+(1-\lambda)\mathbf{x}_2-\mathbf{z}\|\\
&amp;= \|\lambda (\mathbf{x}_1-{\mathbf{y}}_1)+(1-\lambda)(\mathbf{x}_2-{\mathbf{y}}_2)\|\\
&amp;\leq \lambda \|\mathbf{x}_1-{\mathbf{y}}_1\|+(1-\lambda)\|\mathbf{x}_2-{\mathbf{y}}_2\|\\
&amp;=\lambda d_C(\mathbf{x}_1)+(1-\lambda)d_C(\mathbf{x}_2).
\end{align*}\]</span> where the final inequality follows from the triangle inequality. Thus <span class="math inline">\(d_C\)</span> is convex.</p>
<p>This is also true if <span class="math inline">\(C\)</span> is not closed, but the proof is more involved.</p>
</div>
</div>
</div>
</section>
<section id="question-10" class="level2">
<h2 class="anchored" data-anchor-id="question-10">Question 10</h2>
<p>A box is a subset of <span class="math inline">\(\mathbb{R}^{n}\)</span> of the form <span class="math display">\[\begin{align*}
    B=\left[\ell_{1}, u_{1}\right] \times\left[\ell_{2}, u_{2}\right] \times \cdots \times\left[\ell_{n}, u_{n}\right]=\left\{\mathbf{x} \in \mathbb{R}^{n}: \ell_{i} \leq x_{i} \leq u_{i}\right\}\,,
\end{align*}\]</span> where <span class="math inline">\(\ell_{i} \leq u_{i}\)</span> for all <span class="math inline">\(i=1,2, \ldots, n\)</span>. Show that the orthogonal projection for this set is <span class="math display">\[\begin{align*}
    \left[P_{B}(\mathbf{x})\right]_{i}=\left\{\begin{array}{ll}
        u_{i} &amp; x_{i} \geq u_{i} \\
        x_{i} &amp; \ell_{i}&lt;x_{i}&lt;u_{i} \\
        \ell_{i} &amp; x_{i} \leq \ell_{i}
    \end{array}\right.
\end{align*}\]</span></p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The orthogonal projection of <span class="math inline">\(\mathbf{x}\)</span> onto <span class="math inline">\(B\)</span> is the solution to <span class="math display">\[\min_{{\mathbf{y}}\in B}||\mathbf{x}-{\mathbf{y}}||\]</span> or equivalently <span class="math display">\[\min_{{\mathbf{y}}\in B}\sum_i(x_i-y_i)^2\]</span></p>
<p>This is a separable problem, so we just need to consider <span class="math display">\[\min_{y_i\in (\ell_i, u_i)} (x_i-y_i)^2\]</span> for each <span class="math inline">\(i\)</span>. It is easy to see that we have</p>
<p><span class="math display">\[x_i^* = \arg \min_{y_i\in (\ell_i, u_i)} (x_i-y_i)^2 = \left\{\begin{array}{ll}
        u_{i} &amp; x_{i} \geq u_{i} \\
        x_{i} &amp; \ell_{i}&lt;x_{i}&lt;u_{i} \\
        \ell_{i} &amp; x_{i} \leq \ell_{i}
    \end{array}\right.\]</span></p>
<p>as required.</p>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="Week7-convexopt_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>