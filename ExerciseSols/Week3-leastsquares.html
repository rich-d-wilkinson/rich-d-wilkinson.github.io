<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Richard Wilkinson">

<title>Week 3 - least squares: exercise solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Week3-leastsquares_files/libs/clipboard/clipboard.min.js"></script>
<script src="Week3-leastsquares_files/libs/quarto-html/quarto.js"></script>
<script src="Week3-leastsquares_files/libs/quarto-html/popper.min.js"></script>
<script src="Week3-leastsquares_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Week3-leastsquares_files/libs/quarto-html/anchor.min.js"></script>
<link href="Week3-leastsquares_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Week3-leastsquares_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Week3-leastsquares_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Week3-leastsquares_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Week3-leastsquares_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Week 3 - least squares: exercise solutions</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Prof.&nbsp;Richard Wilkinson </p>
            </div>
    </div>
      
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a></li>
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question 7</a></li>
  <li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question 8</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="hidden">

</div>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Prove that <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\succeq 0\)</span>. When is <span class="math inline">\(\mathbf{A}^{T}\mathbf{A}\)</span> positive definite?</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Given <span class="math inline">\(\mathbf{x}\)</span>, let <span class="math inline">\({\mathbf{y}}= \mathbf{A}\mathbf{x}\)</span>. Then <span class="math display">\[\mathbf{x}^\top \mathbf{A}^\top \mathbf{A}\mathbf{x}= {\mathbf{y}}^\top{\mathbf{y}}= \sum y_i^2\geq 0\]</span> Thus <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\succeq 0\)</span>.</p>
<p>If <span class="math inline">\(\mathbf{x}\not = \mathbf{0}\)</span>, we have <span class="math inline">\(\mathbf{x}^\top \mathbf{A}^\top \mathbf{A}\mathbf{x}=0\)</span> only if <span class="math inline">\(\mathbf{A}\mathbf{x}=\mathbf{0}\)</span>. So <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span> is positive definite only if the null space of <span class="math inline">\(\mathbf{A}\)</span> contains only the zero vector, i.e.&nbsp;<span class="math inline">\(null(\mathbf{A}) =\{\mathbf{x}: \mathbf{A}\mathbf{x}=\mathbf{0}\}=\{\mathbf{0}\}.\)</span> This happens when <span class="math inline">\(\mathbf{A}\)</span> is full-rank (by the rank-nullity theorem), i.e.&nbsp;the columns of <span class="math inline">\(\mathbf{A}\)</span> are linearly independent).</p>
</div>
</div>
</div>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>What is the core numerical task for solving linear least squares problem? And when might it be computationally difficult to perform this task?</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have to solve the <span class="math inline">\(n\times n\)</span> system of equations <span class="math display">\[\mathbf{A}^\top \mathbf{A}\mathbf{x}= \mathbf{A}^\top\mathbf{b}\]</span> This generally requires <span class="math inline">\(\mathcal{O}(n^3)\)</span> operations, and so becomes computationally expensive when <span class="math inline">\(n\)</span> is large.</p>
</div>
</div>
</div>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Show that <span class="math inline">\(\sum_{i=1}^r \frac{\mathbf{u}_i \mathbf{u}_i^\top}{d_i}\)</span> is a pseudo-inverse of <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span>, where <span class="math inline">\(d_i, \mathbf{u}_i\)</span> are eigenpairs of <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span>.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\mathbf{B}^+\)</span> is a pseudo inverse of <span class="math inline">\(\mathbf{B}\)</span> if <span class="math inline">\(\mathbf{B}^+\mathbf{B}\mathbf{B}^+=\mathbf{B}^+\)</span> and <span class="math inline">\(\mathbf{B}\mathbf{B}^+\mathbf{B}=\mathbf{B}\)</span>.</p>
<p>If <span class="math inline">\(d_i, \mathbf{u}_i\)</span> are eigenpairs of <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span>, then we can diagonalize <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span> and write <span class="math display">\[\mathbf{A}^\top \mathbf{A}= \mathbf{U}\mathbf{D}\mathbf{U}^\top=\sum_{i=1}^n d_i \mathbf{u}_i\mathbf{u}_i^\top\]</span></p>
<p>Then we can check the condition for a pseudo-inverse, e.g.,</p>
<p><span class="math display">\[\left(\sum_{i=1}^n d_i \mathbf{u}_i\mathbf{u}_i^\top\right)\left(\sum_{i=j}^r \frac{\mathbf{u}_j \mathbf{u}_j^\top}{d_j}\right)\left(\sum_{k=1}^n d_k \mathbf{u}_k\mathbf{u}_k^\top\right)=\sum_{i,j,k} \frac{d_id_j}{d_k} \mathbf{u}_i^\top \mathbf{u}_j \mathbf{u}_j^\top \mathbf{u}_k \mathbf{u}_k^\top  = \sum_{i}d_i \mathbf{u}_i\mathbf{u}_i^\top = \mathbf{A}^\top \mathbf{A}\]</span> as <span class="math inline">\(\mathbf{u}_i^\top \mathbf{u}_j = 1\)</span> if <span class="math inline">\(i=j\)</span> and <span class="math inline">\(0\)</span> otherwise.</p>
<p>Checking the other condition is similar.</p>
</div>
</div>
</div>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>Let <span class="math inline">\(\lambda_i, \mathbf{u}_i\)</span> for <span class="math inline">\(i=1, \ldots, n\)</span> be the eigenpairs of <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span> with <span class="math inline">\(\mathbf{A}^\top\mathbf{A}\mathbf{u}_i = \lambda_i \mathbf{u}_i\)</span> and <span class="math inline">\(\|\mathbf{u}_i\|=1\)</span>. Prove that if <span class="math inline">\(rank(\mathbf{A}^\top \mathbf{A})=r&lt;n\)</span>, then for any <span class="math inline">\(\alpha_{r+1}, \ldots, \alpha_n \in \mathbb{R},\)</span> <span class="math display">\[\mathbf{x}=\mathbf{x}_{LS}+\sum_{i=r+1}^n \alpha_i\mathbf{u}_i\]</span> is a minimizer of <span class="math inline">\(||\mathbf{A}\mathbf{x}- \mathbf{b}||^2_2\)</span>.</p>
<p>Show that the solution with minimum norm is <span class="math inline">\(\mathbf{x}_{LS}\)</span>.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can diagonalize <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\)</span> as <span class="math display">\[\mathbf{A}^\top \mathbf{A}= \mathbf{U}\mathbf{D}\mathbf{U}^\top\]</span> where <span class="math inline">\(\mathbf{U}\)</span> contains the unit eigenvectors <span class="math inline">\(\mathbf{u}_i\)</span> and <span class="math inline">\(\mathbf{D}\)</span> is a diagonal matrix with entries <span class="math inline">\(\lambda_i.\)</span></p>
<p>Because <span class="math inline">\(rank(\mathbf{A}^\top \mathbf{A})=r\)</span> we have <span class="math inline">\(\lambda_{r+1}, \ldots, \lambda_n=0\)</span>. We can thus write <span class="math display">\[\mathbf{A}^\top \mathbf{A}= \sum_{i=1}^r \lambda_i \mathbf{u}_i\mathbf{u}_i^\top.\]</span></p>
<p>We’ve seen in the notes that minimizers of <span class="math inline">\(||\mathbf{A}\mathbf{x}-\mathbf{b}\|_2^2\)</span> satisfy the normal equations <span class="math display">\[\mathbf{A}^\top\mathbf{A}\mathbf{x}= \mathbf{A}^\top \mathbf{b}.\]</span></p>
<p>So if <span class="math inline">\(\mathbf{x}_{LS}=\mathbf{U}\mathbf{D}^{-1}\mathbf{U}\mathbf{A}^\top \mathbf{b}\)</span> is a solution of the normal equations, then so is <span class="math display">\[\mathbf{x}=\mathbf{x}_{LS}+\sum_{i=r+1}^n \alpha_i\mathbf{u}_i\]</span> as <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\mathbf{u}_i = \mathbf{0}\)</span> for <span class="math inline">\(i&gt;r\)</span>.</p>
<p>Consider <span class="math display">\[\|\mathbf{x}\|^2 = \|\mathbf{x}-\mathbf{x}_{LS}+\mathbf{x}_{LS}\|^2= ||\mathbf{x}-\mathbf{x}_{LS}||^2+\|\mathbf{x}_{LS}\|^2\geq \|\mathbf{x}_{LS}\|^2\]</span> as <span class="math display">\[\langle \mathbf{x}-\mathbf{x}_{LS}, \mathbf{x}_{LS}\rangle = \langle \sum_{i=r}^n \alpha_i \mathbf{u}_i, \mathbf{x}_{LS}\rangle =0\]</span> as <span class="math inline">\(\mathbf{x}_{LS} = \sum_{i=1}^r \beta_i \mathbf{u}_i\)</span> for some <span class="math inline">\(\beta_i\)</span>. (In fact we have <span class="math inline">\(\mathrm{beta}=\mathbf{D}^{-1}\mathbf{U}\mathbf{A}^\top \mathbf{b}\)</span>.)</p>
</div>
</div>
</div>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Consider the inconsistent linear system <span class="math display">\[\begin{align*}
    \begin{aligned}
        x_{1}+ x_{2} &amp;=0 \\
        2x_{1}+2x_{2} &amp;=1 \\
    \end{aligned}
\end{align*}\]</span> Characterize all the ‘solutions’ of this system and find the minimum norm solution.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The system is <span class="math display">\[\begin{pmatrix} 1&amp;1\\2 &amp; 2\end{pmatrix}\mathbf{x}=\begin{pmatrix}0\\1\end{pmatrix}\]</span> The system is inconsistent, and so there is no exact solution to these equations. Instead we try to minimize the sum of squared errors <span class="math display">\[(\mathbf{A}\mathbf{x}- \mathbf{b})^\top (\mathbf{A}\mathbf{x}- \mathbf{b})\]</span></p>
<p>The normal equations are <span class="math inline">\(\mathbf{A}^\top \mathbf{A}\mathbf{x}= \mathbf{A}^\top \mathbf{b}\)</span> <span class="math display">\[\begin{pmatrix} 5&amp;5\\5 &amp; 5\end{pmatrix}\mathbf{x}=\begin{pmatrix}2\\2\end{pmatrix}\]</span> We can diagonalize <span class="math inline">\(\mathbf{A}^\top\mathbf{A}\)</span> as <span class="math display">\[\mathbf{A}^\top\mathbf{A}= \begin{pmatrix} \frac{1}{\sqrt{2}}&amp;-\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}}\end{pmatrix}\begin{pmatrix} 10&amp;0\\0 &amp;10\end{pmatrix}
\begin{pmatrix} \frac{1}{\sqrt{2}}&amp;-\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}}\end{pmatrix}^\top=
10\begin{pmatrix} \frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}} \end{pmatrix}
\begin{pmatrix} \frac{1}{\sqrt{2}}&amp;\frac{1}{\sqrt{2}}\end{pmatrix}
\]</span></p>
<p>So the minimum norm solution is</p>
<p><span class="math display">\[(\mathbf{A}^\top\mathbf{A})^+ \mathbf{A}^\top \mathbf{b}= \frac{2}{10}\begin{pmatrix}1\\1\end{pmatrix}\]</span> But any vector of the form</p>
<p><span class="math display">\[\mathbf{x}= \frac{2}{10}\begin{pmatrix}1\\1\end{pmatrix} + \alpha \begin{pmatrix}-\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}} \end{pmatrix}\]</span> for <span class="math inline">\(\alpha\in \mathbb{R}\)</span> is also a solution.</p>
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<p>Suppose we have a noisy set of scales, that we know give unbiased measurements, but which have a zero-mean error that is distributed as a Gaussian random variable with variance <span class="math inline">\(\sigma^2\)</span>. We have three objects we wish to weigh, which have true (unknown) weights <span class="math inline">\(w_1, w_2, w_3\)</span>. We use the scales four times to weigh firstly just object 1, then object 1 and 2, then object 2 and 3, and finally all three objects. The four recorded weights are <span class="math display">\[y_1 = 1.04, \quad
y_2 =  2.73 \quad
y_3=  6.06
\quad y_4= 5.15.\]</span> What is the maximum likelihood estimate of the 3 unknown weights? Recall that the pdf of a Gaussian random variable is <span class="math display">\[p(y | \mu, \sigma^2) = \frac{1}{\sqrt{2\pi \sigma^2}}\exp\left(-\frac{1}{2} (y-\mu)^2\right).\]</span></p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have 4 measurements: <span class="math display">\[\begin{align*}
y_1 &amp;= w_1+e_1\\
y_2 &amp;= w_1+w_2+e_2\\
y_3 &amp;= w_2+w_3+e_3\\
y_4 &amp;= w_1+w_2+w_3+e_2
\end{align*}\]</span> which we can write in vector form as <span class="math display">\[{\mathbf{y}}= \mathbf{A}\mathbf{w}+\mathbf{e}\]</span> The log-likelihood is</p>
<p><span class="math display">\[\log p({\mathbf{y}}|\mathbf{w}) = const - \frac{1}{2\sigma^2}\sum_{i=1}^4 (y_i - \mathbf{a}_i^\top \mathbf{w})^2 = const - \frac{1}{2\sigma^2} ({\mathbf{y}}-\mathbf{A}\mathbf{w})^\top({\mathbf{y}}-\mathbf{A}\mathbf{w})\]</span></p>
<p>So we need to maximize <span class="math inline">\(\log p({\mathbf{y}}| \mathbf{w})\)</span> or equivalently minimize <span class="math display">\[({\mathbf{y}}-\mathbf{A}\mathbf{w})^\top({\mathbf{y}}-\mathbf{A}\mathbf{w})=\|{\mathbf{y}}- \mathbf{A}\mathbf{w}\|^2\]</span> i.e., this is a least-squares problem. We thus know the solution is found by solving the normal equations <span class="math display">\[\begin{align*}
\mathbf{A}^\top \mathbf{A}\mathbf{w}= \mathbf{A}^\top {\mathbf{y}}\\
\begin{pmatrix} 3 &amp; 2 &amp; 1 \\
2 &amp; 3 &amp;2\\
1 &amp; 2 &amp; 2\end{pmatrix}\mathbf{w}=
\begin{pmatrix}1 &amp; 1 &amp; 0&amp; 1\\
0 &amp; 1 &amp; 1 &amp;1\\
0&amp;0&amp;1&amp;1\end{pmatrix} \begin{pmatrix} 1.04\\
2.73\\
6.06\\
5.15
\end{pmatrix}
\end{align*}\]</span> Thus we find <span class="math display">\[\hat{\mathbf{w}}=\begin{pmatrix}
0.39\\2.34\\3.07\end{pmatrix}
\]</span> This is easy in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.04</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fl">2.73</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fl">6.06</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fl">5.15</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">nr=</span><span class="dv">4</span>, <span class="at">byrow=</span>T)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(A)<span class="sc">%*%</span>A, <span class="fu">t</span>(A)<span class="sc">%*%</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,] 0.39
[2,] 2.34
[3,] 3.07</code></pre>
</div>
</div>
<p>Or you can do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y<span class="sc">~</span>A<span class="dv">-1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ A - 1)

Coefficients:
  A1    A2    A3  
0.39  2.34  3.07  </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-7" class="level2">
<h2 class="anchored" data-anchor-id="question-7">Question 7</h2>
<p>A commonly used regularizer is to use the <span class="math inline">\(L_1\)</span> norm, i.e., to minimise<br>
<span class="math display">\[\begin{align*}
    \min \|\mathbf{A} \mathbf{x}-\mathbf{b}\|_2^{2}+\lambda\|\mathbf{D} \mathbf{x}\|_1^{2}\,.
\end{align*}\]</span> Why might it be difficult to solve this problem?</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>One problem is that the <span class="math inline">\(L_1\)</span> norm is not differentiable at <span class="math inline">\(0\)</span>. That means we cannot use gradient descent in the form we have seen. Using an <span class="math inline">\(L_1\)</span> penalty is often called the <a href="https://en.wikipedia.org/wiki/Lasso_(statistics)">Lasso</a>, and it sparsity in the solution. This has proved to be one of the most important developments in statistics in the past 20 years and has led to many useful applications.</p>
</div>
</div>
</div>
</section>
<section id="question-8" class="level2">
<h2 class="anchored" data-anchor-id="question-8">Question 8</h2>
<p>Consider the sum of squares <span class="math display">\[f(\mathbf{x})= \frac{1}{2} \sum_{i=1}^n r_i(\mathbf{x})^2.\]</span></p>
<p>Show that <span class="math display">\[\nabla f(\mathbf{x}) = J(\mathbf{x})^\top \mathbf{r}(\mathbf{x}) \quad\mbox{and}\quad \nabla^2 f(\mathbf{x}) = J(\mathbf{x})^\top J(\mathbf{x}) + \sum_{j=1}^n r_j(\mathbf{x}) \nabla^2 r_j(\mathbf{x})\]</span> where <span class="math display">\[J(\mathbf{x}) = \begin{pmatrix} \nabla r_1(\mathbf{x})^\top\\
\vdots\\
\nabla r_n(\mathbf{x})^\top
\end{pmatrix} \mbox{ and } \mathbf{r}(\mathbf{x}) = \begin{pmatrix} r_1(\mathbf{x})\\
\vdots\\ r_n(\mathbf{x})\end{pmatrix}
\]</span></p>
<p>Check this simplifies to the linear case when <span class="math inline">\(r_i(\mathbf{x})=\mathbf{a}_i^\top \mathbf{x}-y_i\)</span>.</p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\nabla f(\mathbf{x}) = \sum \nabla r_i(\mathbf{x}) r_i(\mathbf{x})=
\begin{pmatrix}| &amp; &amp; |\\
\nabla r_1(\mathbf{x})&amp; \ldots &amp; \nabla r_n(\mathbf{x})\\
| &amp; &amp; |\\\end{pmatrix}\begin{pmatrix} r_1(\mathbf{x})\\
\vdots\\r_n(\mathbf{x})\end{pmatrix}=
J(\mathbf{x})^\top\mathbf{r}(\mathbf{x})\]</span></p>
<p><span class="math display">\[\nabla^2 f(\mathbf{x}) = \sum_i \nabla^2 r_i(\mathbf{x}) r_i(\mathbf{x})+ \nabla r_i(\mathbf{x}) \nabla r_i(\mathbf{x})^\top\]</span> To see this, let’s think about the <span class="math inline">\(ij^{th}\)</span> derivative of one term <span class="math display">\[\frac{\partial^2}{\partial x_i \partial x_j}r(\mathbf{x})^2 = \frac{\partial}{\partial x_i}\left(\frac{\partial r(\mathbf{x})}{\partial x_j}r(\mathbf{x}) \right) = \frac{\partial^2r(\mathbf{x})}{\partial x_i \partial x_j} r(\mathbf{x}) + \frac{\partial r(\mathbf{x})}{\partial x_i}\frac{\partial r(\mathbf{x})}{\partial x_j}\]</span></p>
<p>Writing it as a matrix gives the expression above. We can then write</p>
<p><span class="math display">\[\nabla^2 f(\mathbf{x}) =J(\mathbf{x})^\top J(\mathbf{x})+ \sum_{i=1}^n\nabla^2 r_i(\mathbf{x}) r_i(\mathbf{x})\]</span></p>
<p>If <span class="math inline">\(r_i(\mathbf{x})=(\mathbf{a}_i^\top \mathbf{x}-y_i)^2\)</span> then we have <span class="math inline">\(\mathbf{r}(\mathbf{x})=\mathbf{A}\mathbf{x}-{\mathbf{y}}\)</span> where <span class="math display">\[\mathbf{A}=\begin{pmatrix}\mathbf{a}_1^\top\\\vdots\\\mathbf{a}_n^\top\end{pmatrix}\]</span> and we can write <span class="math display">\[f(\mathbf{x})= \frac{1}{2} \mathbf{r}(\mathbf{x})^\top \mathbf{r}(\mathbf{x})=\frac{1}{2}(\mathbf{A}\mathbf{x}-{\mathbf{y}})^\top(\mathbf{A}\mathbf{x}-{\mathbf{y}}).\]</span></p>
<p>Because <span class="math inline">\(\nabla r_i(\mathbf{x})=\mathbf{a}_i\)</span> we have that <span class="math inline">\(J(\mathbf{x})=\mathbf{A}\)</span>. Thus we find</p>
<p><span class="math display">\[\nabla f(\mathbf{x})= J(\mathbf{x})^\top \mathbf{r}(\mathbf{x}) = \mathbf{A}^\top (\mathbf{A}\mathbf{x}-{\mathbf{y}})\]</span> Finally, because <span class="math inline">\(\nabla^2 r_i(\mathbf{x})=\mathbf{0}\)</span> we see that <span class="math display">\[\nabla^2 f(\mathbf{x})=J(\mathbf{x})^\top J(\mathbf{x})= \mathbf{A}^\top \mathbf{A}\]</span> as expected.</p>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="Week3-leastsquares_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>