<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.5 Computer tasks | Multivariate Statistics</title>
  <meta name="description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="1.5 Computer tasks | Multivariate Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.5 Computer tasks | Multivariate Statistics" />
  
  <meta name="twitter:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

<meta name="author" content="Prof. Richard Wilkinson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1.4-multi-output-linear-model.html"/>
<link rel="next" href="1.6-exercises.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied multivariate statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="1-lm.html"><a href="1-lm.html"><i class="fa fa-check"></i><b>1</b> Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="1-lm.html"><a href="1-lm.html#notation"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="1.1" data-path="1.1-ordinary-least-squares-ols.html"><a href="1.1-ordinary-least-squares-ols.html"><i class="fa fa-check"></i><b>1.1</b> Ordinary least squares (OLS)</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1.1-ordinary-least-squares-ols.html"><a href="1.1-ordinary-least-squares-ols.html#geometry"><i class="fa fa-check"></i><b>1.1.1</b> Geometry</a></li>
<li class="chapter" data-level="1.1.2" data-path="1.1-ordinary-least-squares-ols.html"><a href="1.1-ordinary-least-squares-ols.html#normal-linear-model"><i class="fa fa-check"></i><b>1.1.2</b> Normal linear model</a></li>
<li class="chapter" data-level="1.1.3" data-path="1.1-ordinary-least-squares-ols.html"><a href="1.1-ordinary-least-squares-ols.html#linear-models-in-r"><i class="fa fa-check"></i><b>1.1.3</b> Linear models in R</a></li>
<li class="chapter" data-level="1.1.4" data-path="1.1-ordinary-least-squares-ols.html"><a href="1.1-ordinary-least-squares-ols.html#problems-with-ols"><i class="fa fa-check"></i><b>1.1.4</b> Problems with OLS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1.2-principal-component-regression-pcr.html"><a href="1.2-principal-component-regression-pcr.html"><i class="fa fa-check"></i><b>1.2</b> Principal component regression (PCR)</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1.2-principal-component-regression-pcr.html"><a href="1.2-principal-component-regression-pcr.html#pcr-in-r"><i class="fa fa-check"></i><b>1.2.1</b> PCR in R</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1.3-shrinkage-methods.html"><a href="1.3-shrinkage-methods.html"><i class="fa fa-check"></i><b>1.3</b> Shrinkage methods</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1.3-shrinkage-methods.html"><a href="1.3-shrinkage-methods.html#ridge-regression-in-r"><i class="fa fa-check"></i><b>1.3.1</b> Ridge regression in R</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1.4-multi-output-linear-model.html"><a href="1.4-multi-output-linear-model.html"><i class="fa fa-check"></i><b>1.4</b> Multi-output Linear Model</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1.4-multi-output-linear-model.html"><a href="1.4-multi-output-linear-model.html#normal-linear-model-1"><i class="fa fa-check"></i><b>1.4.1</b> Normal linear model</a></li>
<li class="chapter" data-level="1.4.2" data-path="1.4-multi-output-linear-model.html"><a href="1.4-multi-output-linear-model.html#reduced-rank-regression"><i class="fa fa-check"></i><b>1.4.2</b> Reduced rank regression</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1.5-computer-tasks.html"><a href="1.5-computer-tasks.html"><i class="fa fa-check"></i><b>1.5</b> Computer tasks</a></li>
<li class="chapter" data-level="1.6" data-path="1.6-exercises.html"><a href="1.6-exercises.html"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li> <a href="https://rich-d-wilkinson.github.io/teaching.html" target="blank">University of Nottingham</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computer-tasks" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Computer tasks</h2>
<div id="q1" class="section level5 unnumbered">
<h5>Q1</h5>
<p>The gasoline dataset in the <code>pls</code> dataset consists of data on 60 different gasoline samples. For each sample, the near-infra-read (NIR) spectrum has been measured, which consists of measurements at 401 different wavelengths.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="1.5-computer-tasks.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span>
<span id="cb21-2"><a href="1.5-computer-tasks.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gasoline)</span>
<span id="cb21-3"><a href="1.5-computer-tasks.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="dv">900</span>,<span class="dv">1700</span>,<span class="dv">2</span>),<span class="fu">t</span>(gasoline<span class="sc">$</span>NIR), <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;log(1/R)&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;wavelength (nm)&#39;</span>)</span></code></pre></div>
<p><img src="08-multivarLM-ex_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Also recorded is the octane number of each sample. We will use the NIR measurements to predict the octane number of each sample.
Note that here <span class="math inline">\(n=60\)</span> and <span class="math inline">\(p=401\)</span>, so we have many more covariates than samples.</p>
<ol style="list-style-type: lower-roman">
<li>Start by using the <code>lm</code> command to predict the octane number from the NIR spectra.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="1.5-computer-tasks.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(octane<span class="sc">~</span>NIR, <span class="at">data=</span>gasoline)</span></code></pre></div>
<p>What happens? How many of the coefficients are estimated?</p>
<ol start="2" style="list-style-type: lower-roman">
<li><p>We’ll now try principal component regression. First, project the NIR values onto the first 10 principal components. Then build a linear model using <code>lm</code>. Split the data into a training set containing 40 observations, and a test set containing 20 observations. What is the predictive accuracy of your model?</p></li>
<li><p>Now use the <code>pcr</code> command from the <code>pls</code> package. You can use cross-validation to assess the prediction accuracy, and plot the predictive accuracies, for different number of principal components using the code below.
How many principal components would you retain in your model to ensure the best performance?</p></li>
</ol>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="1.5-computer-tasks.html#cb23-1" aria-hidden="true" tabindex="-1"></a>gasoline.pcr <span class="ot">&lt;-</span> <span class="fu">pcr</span>(octane<span class="sc">~</span>NIR, <span class="at">data=</span>gasoline, <span class="at">validation=</span><span class="st">&#39;CV&#39;</span>)</span>
<span id="cb23-2"><a href="1.5-computer-tasks.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gasoline.pcr)</span>
<span id="cb23-3"><a href="1.5-computer-tasks.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">RMSEP</span>(gasoline.pcr), <span class="at">legendpos =</span> <span class="st">&quot;topright&quot;</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-roman">
<li>Now try ridge regression. What value would you choose for the ridge penalty term <span class="math inline">\(\lambda\)</span>?</li>
</ol>
</div>
<div id="q2" class="section level5 unnumbered">
<h5>Q2</h5>
<p>The <code>lm</code> command in R will automatically work if you pass in a matrix of response variables. To demonstrate this, lets try to predict the sepal width and sepal length from the petal length and widths for the iris data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="1.5-computer-tasks.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">cbind</span>(Sepal.Length, Sepal.Width) <span class="sc">~</span> Petal.Length<span class="sc">+</span>Petal.Width, <span class="at">data=</span>iris)</span></code></pre></div>
<p>Check that the parameter estimates you find are the same as if you did two univariate linear regressions.</p>
<!--##### Q3 {-}

Something linking to CCA?
-->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1.4-multi-output-linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="1.6-exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MultivariateStatistics.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"pandoc_args": "--top-level-division=[chapter|part]"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
