<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 An alternative view of PCA | Multivariate Statistics</title>
  <meta name="description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 An alternative view of PCA | Multivariate Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 An alternative view of PCA | Multivariate Statistics" />
  
  <meta name="twitter:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

<meta name="author" content="Prof. Richard Wilkinson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2-2-pca-a-formal-description-with-proofs.html"/>
<link rel="next" href="2-4-pca-comptask.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied multivariate statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="1-linalg-decomp.html"><a href="1-linalg-decomp.html"><i class="fa fa-check"></i><b>1</b> Matrix decompositions</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-matrix-matrix.html"><a href="1-1-matrix-matrix.html"><i class="fa fa-check"></i><b>1.1</b> Matrix-matrix products</a></li>
<li class="chapter" data-level="1.2" data-path="1-2-spectraleigen-decomposition.html"><a href="1-2-spectraleigen-decomposition.html"><i class="fa fa-check"></i><b>1.2</b> Spectral/eigen decomposition</a><ul>
<li class="chapter" data-level="1.2.1" data-path="1-2-spectraleigen-decomposition.html"><a href="1-2-spectraleigen-decomposition.html#eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>1.2.1</b> Eigenvalues and eigenvectors</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-2-spectraleigen-decomposition.html"><a href="1-2-spectraleigen-decomposition.html#spectral-decomposition"><i class="fa fa-check"></i><b>1.2.2</b> Spectral decomposition</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-2-spectraleigen-decomposition.html"><a href="1-2-spectraleigen-decomposition.html#matrixroots"><i class="fa fa-check"></i><b>1.2.3</b> Matrix square roots</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-3-linalg-SVD.html"><a href="1-3-linalg-SVD.html"><i class="fa fa-check"></i><b>1.3</b> Singular Value Decomposition (SVD)</a><ul>
<li class="chapter" data-level="1.3.1" data-path="1-3-linalg-SVD.html"><a href="1-3-linalg-SVD.html#examples"><i class="fa fa-check"></i><b>1.3.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-4-svdopt.html"><a href="1-4-svdopt.html"><i class="fa fa-check"></i><b>1.4</b> SVD optimization results</a></li>
<li class="chapter" data-level="1.5" data-path="1-5-low-rank-approximation.html"><a href="1-5-low-rank-approximation.html"><i class="fa fa-check"></i><b>1.5</b> Low-rank approximation</a><ul>
<li class="chapter" data-level="1.5.1" data-path="1-5-low-rank-approximation.html"><a href="1-5-low-rank-approximation.html#matrix-norms"><i class="fa fa-check"></i><b>1.5.1</b> Matrix norms</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-5-low-rank-approximation.html"><a href="1-5-low-rank-approximation.html#eckart-young-mirsky-theorem"><i class="fa fa-check"></i><b>1.5.2</b> Eckart-Young-Mirsky Theorem</a></li>
<li class="chapter" data-level="1.5.3" data-path="1-5-low-rank-approximation.html"><a href="1-5-low-rank-approximation.html#example-image-compression"><i class="fa fa-check"></i><b>1.5.3</b> Example: image compression</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-6-tasks-ch3.html"><a href="1-6-tasks-ch3.html"><i class="fa fa-check"></i><b>1.6</b> Computer tasks</a></li>
<li class="chapter" data-level="1.7" data-path="1-7-exercises-ch3.html"><a href="1-7-exercises-ch3.html"><i class="fa fa-check"></i><b>1.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-dimension-reduction-methods.html"><a href="part-ii-dimension-reduction-methods.html"><i class="fa fa-check"></i>PART II: Dimension reduction methods</a><ul>
<li class="chapter" data-level="" data-path="part-ii-dimension-reduction-methods.html"><a href="part-ii-dimension-reduction-methods.html#a-warning"><i class="fa fa-check"></i>A warning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-pca.html"><a href="2-pca.html"><i class="fa fa-check"></i><b>2</b> Principal Component Analysis (PCA)</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html"><i class="fa fa-check"></i><b>2.1</b> PCA: an informal introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html#notation-recap"><i class="fa fa-check"></i><b>2.1.1</b> Notation recap</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html#first-principal-component"><i class="fa fa-check"></i><b>2.1.2</b> First principal component</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html#second-principal-component"><i class="fa fa-check"></i><b>2.1.3</b> Second principal component</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html#geometric-interpretation-1"><i class="fa fa-check"></i><b>2.1.4</b> Geometric interpretation</a></li>
<li class="chapter" data-level="2.1.5" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html#example"><i class="fa fa-check"></i><b>2.1.5</b> Example</a></li>
<li class="chapter" data-level="2.1.6" data-path="2-1-pca-an-informal-introduction.html"><a href="2-1-pca-an-informal-introduction.html#example-iris"><i class="fa fa-check"></i><b>2.1.6</b> Example: Iris</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-2-pca-a-formal-description-with-proofs.html"><a href="2-2-pca-a-formal-description-with-proofs.html"><i class="fa fa-check"></i><b>2.2</b> PCA: a formal description with proofs</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-2-pca-a-formal-description-with-proofs.html"><a href="2-2-pca-a-formal-description-with-proofs.html#properties-of-principal-components"><i class="fa fa-check"></i><b>2.2.1</b> Properties of principal components</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-2-pca-a-formal-description-with-proofs.html"><a href="2-2-pca-a-formal-description-with-proofs.html#pca:football"><i class="fa fa-check"></i><b>2.2.2</b> Example: Football</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-2-pca-a-formal-description-with-proofs.html"><a href="2-2-pca-a-formal-description-with-proofs.html#pcawithR"><i class="fa fa-check"></i><b>2.2.3</b> PCA based on <span class="math inline">\(\mathbf R\)</span> versus PCA based on <span class="math inline">\(\mathbf S\)</span></a></li>
<li class="chapter" data-level="2.2.4" data-path="2-2-pca-a-formal-description-with-proofs.html"><a href="2-2-pca-a-formal-description-with-proofs.html#population-pca"><i class="fa fa-check"></i><b>2.2.4</b> Population PCA</a></li>
<li class="chapter" data-level="2.2.5" data-path="2-2-pca-a-formal-description-with-proofs.html"><a href="2-2-pca-a-formal-description-with-proofs.html#pca-under-transformations-of-variables"><i class="fa fa-check"></i><b>2.2.5</b> PCA under transformations of variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-an-alternative-view-of-pca.html"><a href="2-3-an-alternative-view-of-pca.html"><i class="fa fa-check"></i><b>2.3</b> An alternative view of PCA</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-3-an-alternative-view-of-pca.html"><a href="2-3-an-alternative-view-of-pca.html#example-mnist-handwritten-digits"><i class="fa fa-check"></i><b>2.3.1</b> Example: MNIST handwritten digits</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-4-pca-comptask.html"><a href="2-4-pca-comptask.html"><i class="fa fa-check"></i><b>2.4</b> Computer tasks</a></li>
<li class="chapter" data-level="2.5" data-path="2-5-exercises.html"><a href="2-5-exercises.html"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-mds.html"><a href="3-mds.html"><i class="fa fa-check"></i><b>3</b> Multidimensional Scaling (MDS)</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-classical-mds.html"><a href="3-1-classical-mds.html"><i class="fa fa-check"></i><b>3.1</b> Classical MDS</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-1-classical-mds.html"><a href="3-1-classical-mds.html#non-euclidean-distance-matrices"><i class="fa fa-check"></i><b>3.1.1</b> Non-Euclidean distance matrices</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-1-classical-mds.html"><a href="3-1-classical-mds.html#example-3"><i class="fa fa-check"></i><b>3.1.2</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-2-principal-coordinates.html"><a href="3-2-principal-coordinates.html"><i class="fa fa-check"></i><b>3.2</b> Principal Coordinates</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-properties.html"><a href="3-3-properties.html"><i class="fa fa-check"></i><b>3.3</b> Properties</a></li>
<li class="chapter" data-level="3.4" data-path="3-4-similarity-measures.html"><a href="3-4-similarity-measures.html"><i class="fa fa-check"></i><b>3.4</b> Similarity measures</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-4-similarity-measures.html"><a href="3-4-similarity-measures.html#example-4"><i class="fa fa-check"></i><b>3.4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-5-non-metric-mds.html"><a href="3-5-non-metric-mds.html"><i class="fa fa-check"></i><b>3.5</b> Non-metric MDS</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-exercises-1.html"><a href="3-6-exercises-1.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
<li class="chapter" data-level="3.7" data-path="3-7-computer-tasks.html"><a href="3-7-computer-tasks.html"><i class="fa fa-check"></i><b>3.7</b> Computer Tasks</a></li>
</ul></li>
<li class="divider"></li>
<li> <a href="https://rich-d-wilkinson.github.io/teaching.html" target="blank">University of Nottingham</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="an-alternative-view-of-pca" class="section level2">
<h2><span class="header-section-number">2.3</span> An alternative view of PCA</h2>
<p>In this section, we will again consider the situation in which the sample <span class="math inline">\(\mathbf x_1, \ldots , \mathbf x_n \in \mathbb{R}^p\)</span> have zero mean (replace <span class="math inline">\(\mathbf x_i\)</span> by <span class="math inline">\(\mathbf x_i-\bar{\mathbf x}\)</span> if the mean is not zero).</p>
<p>To recap, in PCA to find the <span class="math inline">\(r\)</span> leading principal components, we solve the optimization problem
<span class="math display">\[\begin{align*}
\mbox{For } k=1, \ldots, r &amp;\mbox{ maximize } \mathbf u_k^\top \mathbf S\mathbf u_k \\
 &amp;\mbox{ subject to } \mathbf u_k^\top \mathbf u_j = \begin{cases}
 1  &amp;\mbox{ if } j=k\\
 0 &amp; \mbox{ otherwise.}
 \end{cases}
 \end{align*}\]</span></p>
<p>We can write this in the form given in the introduction to this chapter (Equation <a href="2-pca.html#eq:dimredopt">(2.1)</a>) as
<span class="math display">\[\begin{align*}
&amp;\mbox{Maximize } \operatorname{tr}(\mathbf U^\top \mathbf S\mathbf U) \\
 &amp;\mbox{ subject to } \mathbf U^\top \mathbf U=\mathbf I_r,
 \end{align*}\]</span>
as <span class="math inline">\(\operatorname{tr}(\mathbf U^\top \mathbf S\mathbf U) = \sum_{k=1}^r \mathbf u_k^\top \mathbf S\mathbf u_k\)</span> if <span class="math inline">\(\mathbf U\)</span> has columns <span class="math inline">\(\mathbf u_1, \ldots, \mathbf u_r\)</span>.</p>
<div id="an-equivalent-problem" class="section level4 unnumbered">
<h4>An equivalent problem</h4>
<p>There is another optimization problem that we sometimes wish to solve, that turns out to be equivalent to the above, thus providing another reason why PCA is so widely used.</p>
<p>Suppose we want to find the best rank-<span class="math inline">\(r\)</span> linear approximation to the data matrix <span class="math inline">\(\mathbf X=\begin{pmatrix}\mathbf x_1&amp; \ldots &amp; \mathbf x_n\end{pmatrix}^\top\)</span> (remember that we’re assuming the data have been column centered, if not, replace <span class="math inline">\(\mathbf X\)</span> by <span class="math inline">\(\mathbf H\mathbf X\)</span>). One way to think about this is seek a <span class="math inline">\(p\times r\)</span> matrix <span class="math inline">\(\mathbf U\)</span> for which the rank <span class="math inline">\(r\)</span> linear model
<span class="math display">\[f(\mathbf y) = \mathbf U\mathbf y\]</span> can be used to represent the data.</p>
<p>Let’s choose <span class="math inline">\(\mathbf y_i\in \mathbb{R}^r\)</span> and <span class="math inline">\(\mathbf U\)</span> to minimize the sum of squared errors
<span class="math display">\[\sum_{i=1}^n ||\mathbf x_i - \mathbf U\mathbf y_i||^2_2.\]</span></p>
<p>If we write
<span class="math display">\[\mathbf Y^\top = \begin{pmatrix} 
| &amp;&amp;|\\
\mathbf y_1&amp; \ldots &amp; \mathbf y_n\\
| &amp;&amp;|
\end{pmatrix}\]</span>
then
<span class="math display">\[\begin{align*}
\sum_{i=1}^n ||\mathbf x_i - \mathbf U\mathbf y_i||^2_2 &amp;=\operatorname{tr}((\mathbf X^\top - \mathbf U\mathbf Y^\top)^\top (\mathbf X^\top - \mathbf U\mathbf Y^\top))\\
&amp;=||\mathbf X^\top - \mathbf U\mathbf Y^\top||_F^2
\end{align*}\]</span></p>
<p>i.e., we’re looking for the rank-<span class="math inline">\(r\)</span> matrix <span class="math inline">\(\mathbf X_r\)</span> that minimizes <span class="math inline">\(||\mathbf X- \mathbf X_r||_F=||\mathbf X^\top - \mathbf X_r^\top||_F\)</span>, noting that we can write an arbitrary rank-<span class="math inline">\(r\)</span> matrix as <span class="math inline">\(\mathbf X_r^\top = \mathbf U\mathbf Y^\top\)</span> for some <span class="math inline">\(p\times r\)</span> matrix <span class="math inline">\(\mathbf U\)</span> and a <span class="math inline">\(n \times r\)</span> matrix <span class="math inline">\(\mathbf Y\)</span>.</p>
<p>It makes sense to restrict the columns of <span class="math inline">\(\mathbf U\)</span> to be orthonormal so that <span class="math inline">\(\mathbf U^\top \mathbf U=\mathbf I_r\)</span> as non-orthonormal coordinates systems are confusing. We know that the <span class="math inline">\(\mathbf u\in \mathcal{C}(\mathbf U)\)</span> (where <span class="math inline">\(\mathcal{C}(\mathbf U)\)</span> is the column space of <span class="math inline">\(\mathbf U\)</span>) that minimizes
<span class="math display">\[||\mathbf x-\mathbf u||_2\]</span>
is the orthogonal projection of <span class="math inline">\(\mathbf x\)</span> onto <span class="math inline">\(\mathcal{C}(\mathbf U)\)</span>, which given the columns of <span class="math inline">\(\mathbf U\)</span> are orthonormal is <span class="math inline">\(\mathbf u= \mathbf U\mathbf U^\top \mathbf x\)</span> (see Section <a href="#orthogproj"><strong>??</strong></a>). So we must have <span class="math inline">\(\mathbf X_r^\top = \mathbf U\mathbf U^\top \mathbf X^\top\)</span> and <span class="math inline">\(\mathbf Y^\top = \mathbf U^\top \mathbf X^\top\)</span>.</p>
<p>So it remains to find the optimal choice for <span class="math inline">\(\mathbf U\)</span> by minimizing
<span class="math display">\[\begin{align*}
||\mathbf X^\top - \mathbf U\mathbf U^\top \mathbf X^\top||_F^2 &amp;=||\mathbf X- \mathbf X\mathbf U\mathbf U^\top ||_F^2\\
&amp;= \operatorname{tr}((\mathbf X- \mathbf X\mathbf U\mathbf U^\top)^\top(\mathbf X- \mathbf X\mathbf U\mathbf U^\top))\\
&amp;= \operatorname{tr}(\mathbf X^\top \mathbf X) - 2 \operatorname{tr}(\mathbf U\mathbf U^\top \mathbf X^\top\mathbf X) +  \operatorname{tr}(\mathbf U\mathbf U^\top \mathbf X^\top\mathbf X\mathbf U\mathbf U^\top)\\
&amp;= \operatorname{tr}(\mathbf X^\top \mathbf X)  - \operatorname{tr}(\mathbf U^\top \mathbf X^\top \mathbf X\mathbf U) 
\end{align*}\]</span>
where we’ve used the fact <span class="math inline">\(\operatorname{tr}(\mathbf A\mathbf B) = \operatorname{tr}(\mathbf B\mathbf A)\)</span> and that <span class="math inline">\(\mathbf U^\top \mathbf U=\mathbf I_r\)</span>.</p>
<p>Minimizing the equation above with respect to <span class="math inline">\(\mathbf U\)</span> is equivalent to maximizing
<span class="math display">\[\operatorname{tr}(\mathbf U^\top \mathbf S\mathbf U) \]</span>
which is the maximum variance objective we used to introduce PCA.</p>
<p>So to summarize, the optimization problem
<span class="math display">\[\begin{align*}
&amp;\mbox{Minimize } ||\mathbf X^\top -\mathbf U\mathbf U^\top \mathbf X^\top||_F \\
 &amp;\mbox{ subject to } \mathbf U^\top \mathbf U=\mathbf I_r,
 \end{align*}\]</span>
is equivalent to (and has the same as) the PCA optimization problem.</p>
</div>
<div id="example-mnist-handwritten-digits" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Example: MNIST handwritten digits</h3>
<p>Let’s consider the MNIST dataset of handwritten digits discussed in Chapter <a href="#stat-prelim"><strong>??</strong></a>. Recall this is a collection of 60,000 digits, each of which has been converted to a <span class="math inline">\(28\times 28\)</span> pixel greyscale image (so <span class="math inline">\(p=784\)</span>).
I’ve made a clean version of the dataset available on Moodle, so you can try this analysis for yourself. Let’s look at just the 3s. I’ve created a plotting function <code>plot.mnist</code>, which is in the code file on Moodle.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">load</span>(<span class="dt">file=</span><span class="st">&quot;mnist.rda&quot;</span>) </a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">source</span>(<span class="st">&#39;mnisttools.R&#39;</span>)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">mnist3 =<span class="st"> </span>mnist<span class="op">$</span>train<span class="op">$</span>x[mnist<span class="op">$</span>train<span class="op">$</span>y<span class="op">==</span><span class="dv">3</span>,] <span class="co"># select just the 3s</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="kw">plot.mnist</span>(mnist3[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,]) <span class="co"># plot the first 12 images</span></a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>We can see there is quite a bit of variation between them.
Now lets look at <span class="math inline">\(\bar{\mathbf x}\)</span>, the average 3.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">xbar=<span class="kw">colMeans</span>(mnist3)</a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="kw">plot.mnist</span>(xbar)</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-34-1.png" width="384" /></p>
<p>We can use the <code>prcomp</code> command to find the principal components. Note that we can’t use the <code>scale=TRUE</code> option as some of the columns are all 0, and so R throws an error as it cannot rescale these to have variance 1. Let’s plot the first few principal components/eigenvectors/loading vectors.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">mnist3.pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(mnist3)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">plot.mnist</span>(mnist3.pca<span class="op">$</span>rotation[,<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>]) </a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>These show the main mode of variability in the 3s. Focusing on the first PC, we can see that this is a form of rotation and causes the 3 to slant either forward or backward. If we wanted a rank-2 approximation to the data we would use
<span class="math display">\[f(\mathbf y) = \bar{\mathbf x} + y_1 \mathbf v_1 + y_2 \mathbf v_2\]</span></p>
<p>Let’s try reconstructing the data with <span class="math inline">\(r=2\)</span>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">r=<span class="dv">2</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2">recon =<span class="st">  </span>mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span><span class="op">:</span>r] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(mnist3.pca<span class="op">$</span>rotation[,<span class="dv">1</span><span class="op">:</span>r])</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="kw">plot.mnist2</span>(<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="dv">12</span>), <span class="dt">byrow=</span>T, <span class="dt">nr=</span><span class="dv">12</span>)<span class="op">+</span>recon[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,])</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>We can see that all of these 3s still look a lot like the average 3, but that they vary in their slant, and the heaviness of the line.</p>
<p>The scree plot shows a sharp decrease in the eigenvalues until about the 100th component, at which point they level off.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">plot</span>(mnist3.pca<span class="op">$</span>sdev) <span class="co"># scree plot</span></a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>It can also be useful to plot the cumulative sum of the total proportion of variance explained by a given number of principal components. I’ve drawn on horizontal lines at 90% and 95% of variance explained, to help identify when we cross these thresholds.
We need 80 components to explain 90% of the variance, and 138 components to explain 95% of the variance.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">cumvar =<span class="st"> </span><span class="dv">100</span><span class="op">*</span><span class="kw">cumsum</span>(mnist3.pca<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(mnist3.pca<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">plot</span>(cumvar, <span class="dt">ylab=</span><span class="st">&quot;Cumulative proportion of variance explained&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Number of PCs used&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">90</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb60-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">min</span>(<span class="kw">which</span>(cumvar<span class="op">&gt;</span><span class="dv">90</span>)), <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb60-5" data-line-number="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">95</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb60-6" data-line-number="6"><span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">min</span>(<span class="kw">which</span>(cumvar<span class="op">&gt;</span><span class="dv">95</span>)), <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Let’s now look at the reconstruction using <span class="math inline">\(r=10, \;50, \;100\)</span> and <span class="math inline">\(500\)</span> components to see how the accuracy changes.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">r=<span class="dv">10</span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2">recon =<span class="st">  </span>mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span><span class="op">:</span>r] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(mnist3.pca<span class="op">$</span>rotation[,<span class="dv">1</span><span class="op">:</span>r])</a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="kw">plot.mnist2</span>(<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="dv">12</span>), <span class="dt">byrow=</span>T, <span class="dt">nr=</span><span class="dv">12</span>)<span class="op">+</span>recon[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,])</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">r=<span class="dv">50</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2">recon =<span class="st">  </span>mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span><span class="op">:</span>r] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(mnist3.pca<span class="op">$</span>rotation[,<span class="dv">1</span><span class="op">:</span>r])</a>
<a class="sourceLine" id="cb62-3" data-line-number="3"><span class="kw">plot.mnist2</span>(<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="dv">12</span>), <span class="dt">byrow=</span>T, <span class="dt">nr=</span><span class="dv">12</span>)<span class="op">+</span>recon[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,])</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">r=<span class="dv">100</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2">recon =<span class="st">  </span>mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span><span class="op">:</span>r] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(mnist3.pca<span class="op">$</span>rotation[,<span class="dv">1</span><span class="op">:</span>r])</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="kw">plot.mnist2</span>(<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="dv">12</span>), <span class="dt">byrow=</span>T, <span class="dt">nr=</span><span class="dv">12</span>)<span class="op">+</span>recon[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,])</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">r=<span class="dv">500</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2">recon =<span class="st">  </span>mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span><span class="op">:</span>r] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(mnist3.pca<span class="op">$</span>rotation[,<span class="dv">1</span><span class="op">:</span>r])</a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="kw">plot.mnist2</span>(<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="dv">12</span>), <span class="dt">byrow=</span>T, <span class="dt">nr=</span><span class="dv">12</span>)<span class="op">+</span>recon[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,])</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>We can see that as the number of components increases the reconstructions start to look more like the original 12 images.</p>
<p>We can visualise the range of 3s by looking at a scatter plot of the first two principal components.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw">qplot</span>(mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span>], mnist3.pca<span class="op">$</span>x[,<span class="dv">2</span>])</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>We can then finding images that differ according to these two PC scores. The first plot below is the 3 with the smallest PC1 score, and the second has the largest PC1 score. The third plot has the smallest PC2 score, and the fourth plot the largest PC2 score.
These four different 3s differ in more than just the first two principal components, but you can see the effect of the PC1 score is to slant the image forward or backward, whereas PC2 changes the thickness of the line.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">image_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">which.min</span>(mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span>]), <span class="kw">which.max</span>(mnist3.pca<span class="op">$</span>x[,<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">                <span class="kw">which.min</span>(mnist3.pca<span class="op">$</span>x[,<span class="dv">2</span>]), <span class="kw">which.max</span>(mnist3.pca<span class="op">$</span>x[,<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="kw">plot.mnist</span>(mnist3[image_list,]) <span class="co"># plot the first 12 images</span></a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>Finally, let’s do PCA on a selection of the 60,000 images (not just the 3s). You can compute the SVD (which is what <code>prcomp</code> uses to do PCA) on a <span class="math inline">\(60,000 \times 784\)</span> matrix, but it takes a long time on most computers, so here I’ve just computed the first two components on a random selection of 5,000 images using the option <code>rank=2</code> which significantly speeds up the computation time.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="co"># Note this is slow to compute!</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2">image_index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">60000</span>, <span class="dt">size=</span><span class="dv">5000</span>) <span class="co"># select a random sample of images</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3">mnist.pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(mnist<span class="op">$</span>train<span class="op">$</span>x[image_index,], <span class="dt">rank=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb67-4" data-line-number="4">Digit =<span class="st"> </span><span class="kw">as.factor</span>(mnist<span class="op">$</span>train<span class="op">$</span>y[image_index])</a>
<a class="sourceLine" id="cb67-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(mnist.pca<span class="op">$</span>x), <span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2, <span class="dt">colour=</span>Digit, <span class="dt">label=</span>Digit))<span class="op">+</span></a>
<a class="sourceLine" id="cb67-6" data-line-number="6"><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>Digit))</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>We can see from this scatter plot that the first two principal components do a surprisingly good job of separating and clustering the digits.</p>
<!--Extensions 

Principal component regression



 Total least squares
-->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-2-pca-a-formal-description-with-proofs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2-4-pca-comptask.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MultivariateStatistics.pdf"],
"toc": {
"collapse": "section"
},
"pandoc_args": "--top-level-division=[chapter|part]"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
