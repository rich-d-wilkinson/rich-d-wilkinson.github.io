<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.1 PCA: an informal introduction | Multivariate Statistics</title>
  <meta name="description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="1.1 PCA: an informal introduction | Multivariate Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.1 PCA: an informal introduction | Multivariate Statistics" />
  
  <meta name="twitter:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

<meta name="author" content="Prof. Richard Wilkinson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1-pca.html"/>
<link rel="next" href="1-2-pca-a-formal-description-with-proofs.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied multivariate statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="part-ii-dimension-reduction-methods.html"><a href="part-ii-dimension-reduction-methods.html"><i class="fa fa-check"></i>PART II: Dimension reduction methods</a><ul>
<li class="chapter" data-level="" data-path="part-ii-dimension-reduction-methods.html"><a href="part-ii-dimension-reduction-methods.html#a-warning"><i class="fa fa-check"></i>A warning</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-pca.html"><a href="1-pca.html"><i class="fa fa-check"></i><b>1</b> Principal component analysis (PCA)</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html"><i class="fa fa-check"></i><b>1.1</b> PCA: an informal introduction</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html#notation-recap"><i class="fa fa-check"></i><b>1.1.1</b> Notation recap</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html#first-principal-component"><i class="fa fa-check"></i><b>1.1.2</b> First principal component</a></li>
<li class="chapter" data-level="1.1.3" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html#second-principal-component"><i class="fa fa-check"></i><b>1.1.3</b> Second principal component</a></li>
<li class="chapter" data-level="1.1.4" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html#geometric-interpretation-1"><i class="fa fa-check"></i><b>1.1.4</b> Geometric interpretation</a></li>
<li class="chapter" data-level="1.1.5" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html#example"><i class="fa fa-check"></i><b>1.1.5</b> Example</a></li>
<li class="chapter" data-level="1.1.6" data-path="1-1-pca-an-informal-introduction.html"><a href="1-1-pca-an-informal-introduction.html#example-iris"><i class="fa fa-check"></i><b>1.1.6</b> Example: Iris</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-2-pca-a-formal-description-with-proofs.html"><a href="1-2-pca-a-formal-description-with-proofs.html"><i class="fa fa-check"></i><b>1.2</b> PCA: a formal description with proofs</a><ul>
<li class="chapter" data-level="1.2.1" data-path="1-2-pca-a-formal-description-with-proofs.html"><a href="1-2-pca-a-formal-description-with-proofs.html#properties-of-principal-components"><i class="fa fa-check"></i><b>1.2.1</b> Properties of principal components</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-2-pca-a-formal-description-with-proofs.html"><a href="1-2-pca-a-formal-description-with-proofs.html#example-football"><i class="fa fa-check"></i><b>1.2.2</b> Example: Football</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-2-pca-a-formal-description-with-proofs.html"><a href="1-2-pca-a-formal-description-with-proofs.html#pcawithR"><i class="fa fa-check"></i><b>1.2.3</b> PCA based on <span class="math inline">\(\boldsymbol R\)</span> versus PCA based on <span class="math inline">\(\boldsymbol S\)</span></a></li>
<li class="chapter" data-level="1.2.4" data-path="1-2-pca-a-formal-description-with-proofs.html"><a href="1-2-pca-a-formal-description-with-proofs.html#population-pca"><i class="fa fa-check"></i><b>1.2.4</b> Population PCA</a></li>
<li class="chapter" data-level="1.2.5" data-path="1-2-pca-a-formal-description-with-proofs.html"><a href="1-2-pca-a-formal-description-with-proofs.html#pca-under-transformations-of-variables"><i class="fa fa-check"></i><b>1.2.5</b> PCA under transformations of variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-3-an-alternative-view-of-pca.html"><a href="1-3-an-alternative-view-of-pca.html"><i class="fa fa-check"></i><b>1.3</b> An alternative view of PCA</a><ul>
<li class="chapter" data-level="1.3.1" data-path="1-3-an-alternative-view-of-pca.html"><a href="1-3-an-alternative-view-of-pca.html#example-mnist-handwritten-digits"><i class="fa fa-check"></i><b>1.3.1</b> Example: MNIST handwritten digits</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-4-computer-tasks.html"><a href="1-4-computer-tasks.html"><i class="fa fa-check"></i><b>1.4</b> Computer tasks</a></li>
<li class="chapter" data-level="1.5" data-path="1-5-exercises.html"><a href="1-5-exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li> <a href="https://rich-d-wilkinson.github.io/teaching.html" target="blank">University of Nottingham</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pca-an-informal-introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> PCA: an informal introduction</h2>
<p>There are two different ways of motivating
principal component analysis (PCA), which may in part explain why PCA is so widely used.</p>
<p>The first motivation, and the topic of this section, is to introduce PCA as method for maximizing the variance of the transformed variables <span class="math inline">\(\boldsymbol y\)</span>. We start by choosing <span class="math inline">\(\boldsymbol u_1\)</span> so that <span class="math inline">\(y_1=\boldsymbol u_1^\top \boldsymbol x\)</span> has maximum variance. We then choose <span class="math inline">\(\boldsymbol u_2\)</span> so that <span class="math inline">\(y_2=\boldsymbol u_2^\top \boldsymbol x\)</span> has maximum variance subject to being uncorrelated with <span class="math inline">\(y_1\)</span>, and so on.</p>
<p>The idea is to produce a set of variables <span class="math inline">\(y_1, y_2, \ldots, y_r\)</span> that are uncorrelated, but which are most informative about the data. The thinking is that if a variable has large variance it must be informative/important.</p>
<p>The name <strong>principal component analysis</strong> comes from thinking of this as splitting the data <span class="math inline">\(\boldsymbol X\)</span> into its most important parts. It therefore won’t surprise you to find that this involves the matrix decompositions we studied in Chapter <a href="#linalg-decomp"><strong>??</strong></a>.</p>
<p><a href="https://twitter.com/allison_horst/status/1288904459490213888?lang=en">Allison Horst (@allison_horst)</a> gave a great illustration of how to think about PCA on Twitter. Imagine you are a whale shark with a wide mouth</p>
<p><img src="figs/WideMouthShark1.png" /></p>
<p>and that you’re swimming towards a delicious swarm of krill.</p>
<p><img src="figs/WideMouthShark2.png" /></p>
<p>What way should you tilt your shark head in order to eat as many krill as possible? The answer is given by the first principal component of the data!</p>
<div id="notation-recap" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Notation recap</h3>
<p>As before, let <span class="math inline">\(\boldsymbol x_1,\ldots,\boldsymbol x_n\)</span> be <span class="math inline">\(p \times 1\)</span> vectors of measurements on <span class="math inline">\(n\)</span> experimental units and write
<span class="math display">\[\boldsymbol X=\left( \begin{array}{ccc}
- &amp;\boldsymbol x_1^\top&amp;-\\
- &amp;\boldsymbol x_2^\top&amp;-\\
- &amp;..&amp;-\\
- &amp;\boldsymbol x_n^\top&amp;-
\end{array}\right)
\]</span></p>
<p><strong>IMPORTANT NOTE:</strong>
In this section we will assume that <span class="math inline">\(\boldsymbol X\)</span> has been column centered so that the mean of each column is <span class="math inline">\(0\)</span> (i.e., the sample mean of <span class="math inline">\(\boldsymbol x_1,\ldots,\boldsymbol x_n\)</span> is the zero vector <span class="math inline">\(\boldsymbol 0\in \mathbb{R}^p\)</span>). If <span class="math inline">\(\boldsymbol X\)</span> has not been column centered, replace <span class="math inline">\(\boldsymbol X\)</span> by
<span class="math display">\[\boldsymbol H\boldsymbol X\]</span> where <span class="math inline">\(\boldsymbol H\)</span> is the centering matrix (see <a href="#centering-matrix"><strong>??</strong></a>), or equivalently, replace <span class="math inline">\(\boldsymbol x_i\)</span> by <span class="math inline">\(\boldsymbol x_i - \bar{\boldsymbol x}\)</span>. It is possible to write out the details of PCA replacing <span class="math inline">\(\boldsymbol X\)</span> by <span class="math inline">\(\boldsymbol H\boldsymbol X\)</span> throughout, but this gets messy and obscures the important detail. Most software implementations (and in particular <code>prcomp</code> in R), automatically centre your data for you, and so in practice you don’t need to worry about doing this when using a software package.</p>
<p>The sample covariance matrix for <span class="math inline">\(\boldsymbol X\)</span> (assuming it has been column centered) is
<span class="math display">\[\boldsymbol S= \frac{1}{n}\boldsymbol X^\top \boldsymbol X= \frac{1}{n}\sum \boldsymbol x_i\boldsymbol x_i^\top\]</span></p>
<p>Given some vector <span class="math inline">\(\boldsymbol u\)</span>, the transformed variables
<span class="math display">\[y_i = \boldsymbol u^\top \boldsymbol x_i\]</span>
have</p>
<ul>
<li><p><strong>mean <span class="math inline">\(0\)</span></strong>:
<span class="math display">\[\bar{y}= \frac{1}{n}\sum_{i=1}^n y_i = \frac{1}{n}\sum_{i=1}^n \boldsymbol u^\top \boldsymbol x_i =\frac{1}{n} \boldsymbol u^\top \sum_{i=1}^n  \boldsymbol x_i = 0\]</span>
as the mean of the <span class="math inline">\(\boldsymbol x_i\)</span> is <span class="math inline">\(\boldsymbol 0\)</span>.</p></li>
<li><p><strong>sample covariance matrix</strong> <span class="math display">\[\boldsymbol u^\top \boldsymbol S\boldsymbol u\]</span>
as
<span class="math display">\[\frac{1}{n} \sum_{i=1}^n y_i^2 = \frac{1}{n} \sum_{i=1}^n \boldsymbol u^\top \boldsymbol x_i \boldsymbol x_i^\top\boldsymbol u= \frac{1}{n}\boldsymbol u^\top \sum_{i=1}^n  \boldsymbol x_i \boldsymbol x_i^\top \boldsymbol u= \boldsymbol u^\top \boldsymbol S\boldsymbol u
\]</span></p></li>
</ul>
</div>
<div id="first-principal-component" class="section level3">
<h3><span class="header-section-number">1.1.2</span> First principal component</h3>
<p>We would like to find the <span class="math inline">\(\boldsymbol u\)</span> which maximises the sample variance, <span class="math inline">\(\boldsymbol u^\top \boldsymbol S\boldsymbol u\)</span> over unit vectors <span class="math inline">\(\boldsymbol u\)</span>, i.e., vectors with <span class="math inline">\(||\boldsymbol u||=1\)</span>. Why do we focus on unit vectors? If we don’t, we could make the variance as large as we like, e.g., if we replace <span class="math inline">\(\boldsymbol u\)</span> by <span class="math inline">\(10\boldsymbol u\)</span> it would increase the variance by a factor of 100. Thus, we constrain the problem and only consider unit vectors for <span class="math inline">\(\boldsymbol u\)</span>.</p>
<p>We know from Proposition <a href="#prp:two8"><strong>??</strong></a> in Section <a href="#svdopt"><strong>??</strong></a> that <span class="math inline">\(\boldsymbol v_1\)</span>, the first eigenvector of <span class="math inline">\(\boldsymbol S\)</span> (also the first right singular vector of <span class="math inline">\(\boldsymbol X\)</span>), maximizes <span class="math inline">\(\boldsymbol u^\top \boldsymbol S\boldsymbol u\)</span> with
<span class="math display">\[  \max_{\boldsymbol u: ||\boldsymbol u||=1} \boldsymbol u^\top \boldsymbol S\boldsymbol u= \boldsymbol v_1 \boldsymbol S\boldsymbol v_1 =\lambda_1\]</span>
where <span class="math inline">\(\lambda_1\)</span> is the largest eigenvalue of <span class="math inline">\(\boldsymbol S\)</span>.</p>
<p>So the first principal component of <span class="math inline">\(\boldsymbol X\)</span> is <span class="math inline">\(\boldsymbol v_1\)</span>, and the first transformed variable (sometimes called a principal component score) is <span class="math inline">\(y_1 = \boldsymbol v_1 ^\top \boldsymbol x\)</span>.
Applying this to each data point we get <span class="math inline">\(n\)</span> instances of this new variable
<span class="math display">\[y_{i1} = \boldsymbol v_1 ^\top \boldsymbol x_i.\]</span></p>
<p><strong>A note on singular values</strong>: We know <span class="math inline">\(\boldsymbol S= \frac{1}{n}\boldsymbol X^\top\boldsymbol X\)</span> and so the eigenvalues of <span class="math inline">\(\boldsymbol S\)</span> are the same as the squared singular values of <span class="math inline">\(\frac{1}{\sqrt{n}} \boldsymbol X\)</span>:</p>
<p><span class="math display">\[\sqrt{\lambda_1} = \sigma_1\left(\frac{1}{\sqrt{n}} \boldsymbol X\right)\]</span></p>
<p>If we scale <span class="math inline">\(\boldsymbol X\)</span> by a factor <span class="math inline">\(c\)</span>, then the singular values are scaled by the same amount, i.e.,
<span class="math display">\[\sigma_i(c\boldsymbol X)=c\sigma_i(\boldsymbol X)\]</span>
and in particular
<span class="math display">\[ \sigma_i\left(\frac{1}{\sqrt{n}} \boldsymbol X\right) = \frac{1}{\sqrt{n}} \sigma_i(\boldsymbol X)\]</span>
We will need to remember this scaling if we use the SVD of <span class="math inline">\(\boldsymbol X\)</span> to do PCA. Note that scaling <span class="math inline">\(\boldsymbol X\)</span> does not change the singular vectors/principal components.</p>
</div>
<div id="second-principal-component" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Second principal component</h3>
<p><span class="math inline">\(y_1\)</span> is the transformed variable that has maximum variance. What should we choose to be our next transformed variable, i.e., what <span class="math inline">\(\boldsymbol u_2\)</span> should we choose for <span class="math inline">\(y_2 = \boldsymbol u_2^\top \boldsymbol x\)</span>? It makes sense to choose <span class="math inline">\(y_2\)</span> to be uncorrelated with <span class="math inline">\(y_1\)</span>, as otherwise it contains some of the same information given by <span class="math inline">\(y_1\)</span>. The sample covariance between <span class="math inline">\(y_1\)</span> and <span class="math inline">\(\boldsymbol u_2^\top \boldsymbol x\)</span> is
<span class="math display">\[\begin{align*}
s_{y_2y_1} &amp;=\frac{1}{n}\sum_{i=1}^n \boldsymbol u_2^\top \boldsymbol x_i \boldsymbol x_i^\top \boldsymbol v_1\\ 
&amp;= \boldsymbol u_2^\top \boldsymbol S\boldsymbol v_1\\
&amp; = \lambda_1 \boldsymbol u_2^\top \boldsymbol v_1 \mbox{ as } \boldsymbol v_1 \mbox{ is an eigenvector of } S
\end{align*}\]</span>
So to make <span class="math inline">\(y_2\)</span> uncorrelated with <span class="math inline">\(y_1\)</span> we have to choose <span class="math inline">\(\boldsymbol u_2\)</span> to be orthogonal to <span class="math inline">\(\boldsymbol v_1\)</span>, i.e., <span class="math inline">\(\boldsymbol u_2^\top \boldsymbol v_1=0\)</span>. So we choose <span class="math inline">\(\boldsymbol u_2\)</span> to be the solution to the optimization problem</p>
<p><span class="math display">\[\max_{\boldsymbol u} \boldsymbol u^\top \boldsymbol S\boldsymbol u\mbox{ subject to } \boldsymbol u^\top \boldsymbol v_1=0.\]</span>
The solution to this problem is to take <span class="math inline">\(\boldsymbol u_2 = \boldsymbol v_2\)</span>, i.e., the second eigenvector of <span class="math inline">\(\boldsymbol S\)</span> (or second right singular vector of <span class="math inline">\(\boldsymbol X\)</span>), and then <span class="math display">\[\boldsymbol v_2^\top \boldsymbol S\boldsymbol v_2=\lambda_2.\]</span>
We’ll prove this result in the next section.</p>
<div id="later-principal-components" class="section level4 unnumbered">
<h4>Later principal components</h4>
<p>Our first transformed variable is
<span class="math display">\[y_{i1}= \boldsymbol v_1^\top \boldsymbol x_i\]</span>
and our second transformed variable is
<span class="math display">\[y_{i2}= \boldsymbol v_2^\top \boldsymbol x_i.\]</span>
At this point, you can probably guess that the <span class="math inline">\(j^{th}\)</span> transformed variable is going to be
<span class="math display">\[y_{ij}= \boldsymbol v_j^\top \boldsymbol x_i.\]</span>
where <span class="math inline">\(\boldsymbol v_j\)</span> is the <span class="math inline">\(j^{th}\)</span> eigenvector of <span class="math inline">\(\boldsymbol S\)</span>.</p>
<ul>
<li>The transformed variables <span class="math inline">\(y_{i}\)</span> are the <strong>principal component scores</strong>. <span class="math inline">\(y_1\)</span> is the first score etc.</li>
<li>The eigenvectors/right singular vectors are sometimes refered to as the <strong>loadings</strong> or simply as the <strong>principal components</strong>.</li>
</ul>
</div>
</div>
<div id="geometric-interpretation-1" class="section level3">
<h3><span class="header-section-number">1.1.4</span> Geometric interpretation</h3>
<p>We think of PCA as projecting the data points <span class="math inline">\(\boldsymbol x\)</span> onto a subspace <span class="math inline">\(V\)</span>. The basis vectors for this subspace are the eigenvectors of <span class="math inline">\(\boldsymbol S\)</span>, which are the same as the right singular vectors of <span class="math inline">\(\boldsymbol X\)</span> (the loadings):
<span class="math display">\[V=\operatorname{span}\{\boldsymbol v_1, \ldots, \boldsymbol v_r\}.\]</span>
The orthogonal projection matrix (see Section <a href="#orthogproj"><strong>??</strong></a>) for projecting onto <span class="math inline">\(V\)</span> is
<span class="math display">\[\boldsymbol P_V = \boldsymbol V\boldsymbol V^\top\]</span>
as <span class="math inline">\(\boldsymbol V^\top \boldsymbol V=\mathbf I\)</span>.<br />
The coordinates of the data points projected onto <span class="math inline">\(V\)</span> (with respect to the basis for <span class="math inline">\(V\)</span>) are the <strong>principal component scores</strong>:</p>
<p><span class="math display">\[\boldsymbol y_i= \left(\begin{array}{c}y_{i1}\\\vdots\\y_{ir}\end{array}\right)= \boldsymbol V^\top \boldsymbol x_i\]</span>
where <span class="math display">\[\boldsymbol V= \left(\begin{array}{ccc} | &amp;&amp;|\\\boldsymbol v_1&amp;\ldots&amp; \boldsymbol v_r\\  | &amp;&amp;|\end{array}\right)\]</span>
is the matrix of right singular vectors from the SVD of <span class="math inline">\(\boldsymbol X\)</span>.
The transformed variables are</p>
<p><span class="math display">\[\boldsymbol Y= \left( \begin{array}{ccc}
- &amp;\boldsymbol y_1^\top&amp;-\\
- &amp;..&amp;-\\
- &amp;\boldsymbol y_n^\top&amp;-
\end{array}\right ) = \boldsymbol X\boldsymbol V.
\]</span>
Substituting the SVD for <span class="math inline">\(\boldsymbol X= \boldsymbol U\boldsymbol \Sigma\boldsymbol V^\top\)</span> we can see the transformed variable matrix/principal component scores are
<span class="math display">\[\boldsymbol Y= \boldsymbol U\boldsymbol \Sigma.\]</span></p>
<p><span class="math inline">\(\boldsymbol Y\)</span> is a <span class="math inline">\(n \times r\)</span> matrix, and so if <span class="math inline">\(r&lt;p\)</span> we have reduced the dimension of <span class="math inline">\(\boldsymbol X\)</span>, keeping the most important parts of the data</p>
</div>
<div id="example" class="section level3">
<h3><span class="header-section-number">1.1.5</span> Example</h3>
<p>We consider the marks of <span class="math inline">\(n=10\)</span> students who studied G11PRB and G11STA.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
student
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
STA
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
75
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
73
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
79
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
53
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
49
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
58
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
56
</td>
</tr>
</tbody>
</table>
<p>These data haven’t been column centered, so let’s do that in R. You can do it using the centering matrix as previously, but here is a different approach:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">secondyr &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="dt">student =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="dt">PRB=</span><span class="kw">c</span>(<span class="dv">81</span> , <span class="dv">79</span> , <span class="dv">66</span> , <span class="dv">53</span> , <span class="dv">43</span> , <span class="dv">59</span> , <span class="dv">62</span> , <span class="dv">79</span> , <span class="dv">49</span> , <span class="dv">55</span>),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="dt">STA =</span><span class="kw">c</span>(<span class="dv">75</span> , <span class="dv">73</span> , <span class="dv">79</span> , <span class="dv">55</span> , <span class="dv">53</span> , <span class="dv">49</span> , <span class="dv">72</span> , <span class="dv">92</span> , <span class="dv">58</span> , <span class="dv">56</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">        )</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(secondyr[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]) <span class="co">#only columns 2 and 3 are data</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">sweep</span>(secondyr[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>], <span class="dv">2</span>, xbar) )</a></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
STA
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
18.4
</td>
<td style="text-align:right;">
8.8
</td>
</tr>
<tr>
<td style="text-align:right;">
16.4
</td>
<td style="text-align:right;">
6.8
</td>
</tr>
<tr>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
<tr>
<td style="text-align:right;">
-9.6
</td>
<td style="text-align:right;">
-11.2
</td>
</tr>
<tr>
<td style="text-align:right;">
-19.6
</td>
<td style="text-align:right;">
-13.2
</td>
</tr>
<tr>
<td style="text-align:right;">
-3.6
</td>
<td style="text-align:right;">
-17.2
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.6
</td>
<td style="text-align:right;">
5.8
</td>
</tr>
<tr>
<td style="text-align:right;">
16.4
</td>
<td style="text-align:right;">
25.8
</td>
</tr>
<tr>
<td style="text-align:right;">
-13.6
</td>
<td style="text-align:right;">
-8.2
</td>
</tr>
<tr>
<td style="text-align:right;">
-7.6
</td>
<td style="text-align:right;">
-10.2
</td>
</tr>
</tbody>
</table>
<p>The sample covariance matrix can be computed in two ways:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="dv">1</span><span class="op">/</span><span class="dv">10</span><span class="op">*</span><span class="st"> </span><span class="kw">t</span>(X)<span class="op">%*%</span>X</a></code></pre></div>
<pre><code>##        PRB    STA
## PRB 162.04 135.38
## STA 135.38 175.36</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">cov</span>(X)<span class="op">*</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span> </a></code></pre></div>
<pre><code>##        PRB    STA
## PRB 162.04 135.38
## STA 135.38 175.36</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Remember R uses the unbiased factor 1/(n-1), so the 9/10=(n-1)/n changes this to 1/n </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co"># to match the notes</span></a></code></pre></div>
<p>We can find the singular value decomposition of <span class="math inline">\(\boldsymbol X\)</span> using R</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">(<span class="dt">X_svd =</span> <span class="kw">svd</span>(X))</a></code></pre></div>
<pre><code>## $d
## [1] 55.15829 18.20887
## 
## $u
##              [,1]        [,2]
##  [1,] -0.34556317 -0.39864295
##  [2,] -0.29430029 -0.39482564
##  [3,] -0.21057607  0.34946080
##  [4,]  0.26707104 -0.04226416
##  [5,]  0.41833934  0.27975879
##  [6,]  0.27085156 -0.50812066
##  [7,] -0.06865802  0.24349429
##  [8,] -0.54378479  0.32464825
##  [9,]  0.27768146  0.23043980
## [10,]  0.22893893 -0.08394852
## 
## $v
##            [,1]       [,2]
## [1,] -0.6895160 -0.7242705
## [2,] -0.7242705  0.6895160</code></pre>
<p>So we can see that the eigenvectors/right singular vectors/loadings are</p>
<p><span class="math display">\[\boldsymbol v_1=\begin{pmatrix} -0.69 \\ -0.724 \end{pmatrix},\qquad \boldsymbol v_2=\begin{pmatrix} -0.724 \\ 0.69 \end{pmatrix}\]</span></p>
<p>Sometimes the new variables have an obvious interpretation. In this case the first PC gives approximately equal weight to PRB and STA and thus represents some form of negative ‘’average’’ mark. Note that the singular vectors are only determined upto multiplication by <span class="math inline">\(\pm 1\)</span>. In this case, R has chosen <span class="math inline">\(\boldsymbol v_1\)</span> to have negative entries, but we could multiply <span class="math inline">\(\boldsymbol v_1\)</span> by <span class="math inline">\(-1\)</span> so that the first PC was more like the avearge.
As it is, a student that has a high mark on PRB and STA will have a low negative value for <span class="math inline">\(y_1\)</span>. The second PC, meanwhile, represents a contrast between PRB and STA. For example, a large positive value for <span class="math inline">\(y_2\)</span> implies the student did much better on STA than PRB, and a large negative value implies the opposite.</p>
<p>If we plot the data along with the principal components. The two lines, centred on <span class="math inline">\(\bar{\boldsymbol x}\)</span>, are in the direction of the principal components/eigenvectors, and their lengths are <span class="math inline">\(2 \sqrt{\lambda_j}\)</span>, <span class="math inline">\(j=1,2\)</span>.
We can see that the first PC is in the direction of greatest variation (shown in red), and that the second PC (shown in green) is orthogonal to the first PC.</p>
<p><img src="04-pca_files/figure-html/unnamed-chunk-8-1.png" width="576" /></p>
<p>We can find the transformed variables by computing either <span class="math inline">\(\boldsymbol X\boldsymbol V\)</span> or <span class="math inline">\(\boldsymbol U\boldsymbol \Sigma\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">X <span class="op">%*%</span><span class="st"> </span>X_svd<span class="op">$</span>v</a></code></pre></div>
<pre><code>##             [,1]       [,2]
##  [1,] -19.060674 -7.2588361
##  [2,] -16.233101 -7.1893271
##  [3,] -11.615016  6.3632849
##  [4,]  14.731183 -0.7695824
##  [5,]  23.074883  5.0940904
##  [6,]  14.939710 -9.2523011
##  [7,]  -3.787059  4.4337549
##  [8,] -29.994240  5.9114764
##  [9,]  15.316435  4.1960474
## [10,]  12.627880 -1.5286074</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">X_svd<span class="op">$</span>u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(X_svd<span class="op">$</span>d)</a></code></pre></div>
<pre><code>##             [,1]       [,2]
##  [1,] -19.060674 -7.2588361
##  [2,] -16.233101 -7.1893271
##  [3,] -11.615016  6.3632849
##  [4,]  14.731183 -0.7695824
##  [5,]  23.074883  5.0940904
##  [6,]  14.939710 -9.2523011
##  [7,]  -3.787059  4.4337549
##  [8,] -29.994240  5.9114764
##  [9,]  15.316435  4.1960474
## [10,]  12.627880 -1.5286074</code></pre>
<p>If we plot the PC scores we can see that the variation is now in line with the new coordinate axes:
<img src="04-pca_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>R also has a built-in function for doing PCA.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(secondyr[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]) <span class="co"># prcomp will automatocally remove the column mean</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">pca<span class="op">$</span>rotation <span class="co"># the loadings</span></a></code></pre></div>
<pre><code>##            PC1        PC2
## PRB -0.6895160 -0.7242705
## STA -0.7242705  0.6895160</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">pca<span class="op">$</span>x <span class="co"># the scores</span></a></code></pre></div>
<pre><code>##              PC1        PC2
##  [1,] -19.060674 -7.2588361
##  [2,] -16.233101 -7.1893271
##  [3,] -11.615016  6.3632849
##  [4,]  14.731183 -0.7695824
##  [5,]  23.074883  5.0940904
##  [6,]  14.939710 -9.2523011
##  [7,]  -3.787059  4.4337549
##  [8,] -29.994240  5.9114764
##  [9,]  15.316435  4.1960474
## [10,]  12.627880 -1.5286074</code></pre>
<p>```</p>
<p>Note that the new variables have sample mean <span class="math inline">\(\bar{\boldsymbol y}=\boldsymbol 0\)</span>. The sample covariance matrix is a diagonal with entries given by the eigenvalues (see part 4. of Proposition <a href="1-2-pca-a-formal-description-with-proofs.html#prp:pca1">1.1</a>). Note that there is always some numerical error (so quantities are never 0, and instead are just very small numnbers).</p>
<p><span class="math display">\[
\boldsymbol \Lambda= \text{diag}(\lambda_1,\lambda_2) =  \begin{pmatrix} \lambda_1 &amp; 0 \\ 0 &amp; \lambda_2 \end{pmatrix}.
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">colMeans</span>(pca<span class="op">$</span>x)</a></code></pre></div>
<pre><code>##           PC1           PC2 
##  2.842171e-15 -9.769963e-16</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">cov</span>(pca<span class="op">$</span>x)<span class="op">*</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span> <span class="co"># to convert to using 1/n as the denominator </span></a></code></pre></div>
<pre><code>##              PC1          PC2
## PC1 3.042437e+02 1.974167e-14
## PC2 1.974167e-14 3.315628e+01</code></pre>
<p>Finally, note that we did the singular value decomposition for <span class="math inline">\(\boldsymbol X\)</span> above not <span class="math inline">\(\frac{1}{\sqrt{10}}\boldsymbol X\)</span>, and so we’d need to square and scale the singular values to find the eigenvalues. Let’s check:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">X_svd<span class="op">$</span>d<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10</span> <span class="co"># square and scale the singular values</span></a></code></pre></div>
<pre><code>## [1] 304.24372  33.15628</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">eigen</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X<span class="op">/</span><span class="dv">10</span>)<span class="op">$</span>values  <span class="co"># compute the eigenvalues of the covariance matrix</span></a></code></pre></div>
<pre><code>## [1] 304.24372  33.15628</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">svd</span>(X<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>))<span class="op">$</span>d<span class="op">^</span><span class="dv">2</span> <span class="co"># compute the singular values of X/sqrt(10) and square</span></a></code></pre></div>
<pre><code>## [1] 304.24372  33.15628</code></pre>
</div>
<div id="example-iris" class="section level3">
<h3><span class="header-section-number">1.1.6</span> Example: Iris</h3>
<p>In general when using R to do PCA, we don’t need to compute the SVD and then do the projections, as there is an R command <code>prcomp</code> that will do it all for us. The <code>princomp</code> will also do PCA, but is less stable than <code>prcomp</code>, and it is recommended that you use <code>prcomp</code> in preference.</p>
<p>Let’s do PCA on the iris dataset discussed in Chapter <a href="#stat-prelim"><strong>??</strong></a>. The <code>prcomp</code> returns the square root of the eigenvalues (the standard devaiation of the PC scores), and the PC scores.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">iris.pca =<span class="st"> </span><span class="kw">prcomp</span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">iris.pca<span class="op">$</span>sdev <span class="co"># the square root of the eigenvalues</span></a></code></pre></div>
<pre><code>## [1] 2.0562689 0.4926162 0.2796596 0.1543862</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">head</span>(iris.pca<span class="op">$</span>x)  <span class="co">#the PC scores</span></a></code></pre></div>
<pre><code>##            PC1        PC2         PC3          PC4
## [1,] -2.684126 -0.3193972  0.02791483  0.002262437
## [2,] -2.714142  0.1770012  0.21046427  0.099026550
## [3,] -2.888991  0.1449494 -0.01790026  0.019968390
## [4,] -2.745343  0.3182990 -0.03155937 -0.075575817
## [5,] -2.728717 -0.3267545 -0.09007924 -0.061258593
## [6,] -2.280860 -0.7413304 -0.16867766 -0.024200858</code></pre>
<p>The PC loadings/eigenvectors can also be accessed, as can the sample mean</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">iris.pca<span class="op">$</span>rotation <span class="co">#the eigenvecstors</span></a></code></pre></div>
<pre><code>##                      PC1         PC2         PC3        PC4
## Sepal.Length  0.36138659 -0.65658877  0.58202985  0.3154872
## Sepal.Width  -0.08452251 -0.73016143 -0.59791083 -0.3197231
## Petal.Length  0.85667061  0.17337266 -0.07623608 -0.4798390
## Petal.Width   0.35828920  0.07548102 -0.54583143  0.7536574</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">iris.pca<span class="op">$</span>center <span class="co"># the sample mean of the data</span></a></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##     5.843333     3.057333     3.758000     1.199333</code></pre>
<p>A scree plot can be obtained simply by using the <code>plot</code> command. The summary command also gives useful information about the importance of each PC.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">plot</span>(iris.pca)</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">summary</span>(iris.pca)</a></code></pre></div>
<pre><code>## Importance of components:
##                           PC1     PC2    PC3     PC4
## Standard deviation     2.0563 0.49262 0.2797 0.15439
## Proportion of Variance 0.9246 0.05307 0.0171 0.00521
## Cumulative Proportion  0.9246 0.97769 0.9948 1.00000</code></pre>
<p>To plot the PC scores, you can either manually create a plot or use the <code>ggfortify</code> package. For example, here is a plot of the first two PC scores coloured according to the species of iris.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">iris<span class="op">$</span>PC1=iris.pca<span class="op">$</span>x[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">iris<span class="op">$</span>PC2=iris.pca<span class="op">$</span>x[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">qplot</span>(PC1, PC2, <span class="dt">colour=</span>Species, <span class="dt">data=</span>iris)</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The <code>ggfortify</code> package provides a nice wrapper for some of this functionality.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">library</span>(ggfortify)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">autoplot</span>(iris.pca, <span class="dt">data =</span> iris, <span class="dt">colour =</span> <span class="st">&#39;Species&#39;</span>)</a></code></pre></div>
<p><img src="04-pca_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1-pca.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="1-2-pca-a-formal-description-with-proofs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MultivariateStatistics.pdf"],
"toc": {
"collapse": "section"
},
"pandoc_args": "--top-level-division=[chapter|part]"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
