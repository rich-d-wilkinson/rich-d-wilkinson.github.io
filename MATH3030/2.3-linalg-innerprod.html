<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Inner product spaces | Multivariate Statistics</title>
  <meta name="description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Inner product spaces | Multivariate Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Inner product spaces | Multivariate Statistics" />
  
  <meta name="twitter:description" content="The lecture notes for MATH3030/4068: Multivariate Analysis / Applied Multivariate Statistics" />
  

<meta name="author" content="Dr Katie Severn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2.2-linalg-vecspaces.html"/>
<link rel="next" href="2.4-centering-matrix.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied multivariate statistics</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="part-i-prerequisites.html#part-i-prerequisites" id="toc-part-i-prerequisites">PART I: Prerequisites</a></li>
<li><a href="1-stat-prelim.html#stat-prelim" id="toc-stat-prelim"><span class="toc-section-number">1</span> Statistical Preliminaries</a>
<ul>
<li><a href="1.1-notation.html#notation" id="toc-notation"><span class="toc-section-number">1.1</span> Notation</a>
<ul>
<li><a href="1.1-notation.html#example-datasets" id="toc-example-datasets"><span class="toc-section-number">1.1.1</span> Example datasets</a></li>
<li><a href="1.1-notation.html#aims-of-multivariate-data-analysis" id="toc-aims-of-multivariate-data-analysis"><span class="toc-section-number">1.1.2</span> Aims of multivariate data analysis</a></li>
</ul></li>
<li><a href="1.2-exploratory-data-analysis-eda.html#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda"><span class="toc-section-number">1.2</span> Exploratory data analysis (EDA)</a>
<ul>
<li><a href="1.2-exploratory-data-analysis-eda.html#data-visualization" id="toc-data-visualization"><span class="toc-section-number">1.2.1</span> Data visualization</a></li>
<li><a href="1.2-exploratory-data-analysis-eda.html#summary-statistics" id="toc-summary-statistics"><span class="toc-section-number">1.2.2</span> Summary statistics</a></li>
</ul></li>
<li><a href="1.3-randvec.html#randvec" id="toc-randvec"><span class="toc-section-number">1.3</span> Random vectors and matrices</a>
<ul>
<li><a href="1.3-randvec.html#estimators" id="toc-estimators"><span class="toc-section-number">1.3.1</span> Estimators</a></li>
</ul></li>
<li><a href="1.4-computer-tasks.html#computer-tasks" id="toc-computer-tasks"><span class="toc-section-number">1.4</span> Computer tasks</a></li>
<li><a href="1.5-exercises.html#exercises" id="toc-exercises"><span class="toc-section-number">1.5</span> Exercises</a></li>
</ul></li>
<li><a href="2-linalg-prelim.html#linalg-prelim" id="toc-linalg-prelim"><span class="toc-section-number">2</span> Review of linear algebra</a>
<ul>
<li><a href="2.1-linalg-basics.html#linalg-basics" id="toc-linalg-basics"><span class="toc-section-number">2.1</span> Basics</a>
<ul>
<li><a href="2.1-linalg-basics.html#notation-1" id="toc-notation-1"><span class="toc-section-number">2.1.1</span> Notation</a></li>
<li><a href="2.1-linalg-basics.html#elementary-matrix-operations" id="toc-elementary-matrix-operations"><span class="toc-section-number">2.1.2</span> Elementary matrix operations</a></li>
<li><a href="2.1-linalg-basics.html#special-matrices" id="toc-special-matrices"><span class="toc-section-number">2.1.3</span> Special matrices</a></li>
<li><a href="2.1-linalg-basics.html#vectordiff" id="toc-vectordiff"><span class="toc-section-number">2.1.4</span> Vector Differentiation</a></li>
</ul></li>
<li><a href="2.2-linalg-vecspaces.html#linalg-vecspaces" id="toc-linalg-vecspaces"><span class="toc-section-number">2.2</span> Vector spaces</a>
<ul>
<li><a href="2.2-linalg-vecspaces.html#linear-independence" id="toc-linear-independence"><span class="toc-section-number">2.2.1</span> Linear independence</a></li>
<li><a href="2.2-linalg-vecspaces.html#colsspace" id="toc-colsspace"><span class="toc-section-number">2.2.2</span> Row and column spaces</a></li>
<li><a href="2.2-linalg-vecspaces.html#linear-transformations" id="toc-linear-transformations"><span class="toc-section-number">2.2.3</span> Linear transformations</a></li>
</ul></li>
<li><a href="2.3-linalg-innerprod.html#linalg-innerprod" id="toc-linalg-innerprod"><span class="toc-section-number">2.3</span> Inner product spaces</a>
<ul>
<li><a href="2.3-linalg-innerprod.html#normed" id="toc-normed"><span class="toc-section-number">2.3.1</span> Distances, and angles</a></li>
<li><a href="2.3-linalg-innerprod.html#orthogonal-matrices" id="toc-orthogonal-matrices"><span class="toc-section-number">2.3.2</span> Orthogonal matrices</a></li>
<li><a href="2.3-linalg-innerprod.html#projection-matrix" id="toc-projection-matrix"><span class="toc-section-number">2.3.3</span> Projections</a></li>
</ul></li>
<li><a href="2.4-centering-matrix.html#centering-matrix" id="toc-centering-matrix"><span class="toc-section-number">2.4</span> The Centering Matrix</a></li>
<li><a href="2.5-tasks-ch2.html#tasks-ch2" id="toc-tasks-ch2"><span class="toc-section-number">2.5</span> Computer tasks</a></li>
<li><a href="2.6-exercises-ch2.html#exercises-ch2" id="toc-exercises-ch2"><span class="toc-section-number">2.6</span> Exercises</a></li>
</ul></li>
<li><a href="3-linalg-decomp.html#linalg-decomp" id="toc-linalg-decomp"><span class="toc-section-number">3</span> Matrix decompositions</a>
<ul>
<li><a href="3.1-matrix-matrix.html#matrix-matrix" id="toc-matrix-matrix"><span class="toc-section-number">3.1</span> Matrix-matrix products</a></li>
<li><a href="3.2-spectraleigen-decomposition.html#spectraleigen-decomposition" id="toc-spectraleigen-decomposition"><span class="toc-section-number">3.2</span> Spectral/eigen decomposition</a>
<ul>
<li><a href="3.2-spectraleigen-decomposition.html#eigenvalues-and-eigenvectors" id="toc-eigenvalues-and-eigenvectors"><span class="toc-section-number">3.2.1</span> Eigenvalues and eigenvectors</a></li>
<li><a href="3.2-spectraleigen-decomposition.html#spectral-decomposition" id="toc-spectral-decomposition"><span class="toc-section-number">3.2.2</span> Spectral decomposition</a></li>
<li><a href="3.2-spectraleigen-decomposition.html#matrixroots" id="toc-matrixroots"><span class="toc-section-number">3.2.3</span> Matrix square roots</a></li>
</ul></li>
<li><a href="3.3-linalg-SVD.html#linalg-SVD" id="toc-linalg-SVD"><span class="toc-section-number">3.3</span> Singular Value Decomposition (SVD)</a>
<ul>
<li><a href="3.3-linalg-SVD.html#examples" id="toc-examples"><span class="toc-section-number">3.3.1</span> Examples</a></li>
</ul></li>
<li><a href="3.4-svdopt.html#svdopt" id="toc-svdopt"><span class="toc-section-number">3.4</span> SVD optimization results</a></li>
<li><a href="3.5-lowrank.html#lowrank" id="toc-lowrank"><span class="toc-section-number">3.5</span> Low-rank approximation</a>
<ul>
<li><a href="3.5-lowrank.html#matrix-norms" id="toc-matrix-norms"><span class="toc-section-number">3.5.1</span> Matrix norms</a></li>
<li><a href="3.5-lowrank.html#eckart-young-mirsky-theorem" id="toc-eckart-young-mirsky-theorem"><span class="toc-section-number">3.5.2</span> Eckart-Young-Mirsky Theorem</a></li>
<li><a href="3.5-lowrank.html#example-image-compression" id="toc-example-image-compression"><span class="toc-section-number">3.5.3</span> Example: image compression</a></li>
</ul></li>
<li><a href="3.6-tasks-ch3.html#tasks-ch3" id="toc-tasks-ch3"><span class="toc-section-number">3.6</span> Computer tasks</a></li>
<li><a href="3.7-exercises-ch3.html#exercises-ch3" id="toc-exercises-ch3"><span class="toc-section-number">3.7</span> Exercises</a></li>
</ul></li>
<li><a href="part-ii-dimension-reduction-methods.html#part-ii-dimension-reduction-methods" id="toc-part-ii-dimension-reduction-methods">PART II: Dimension reduction methods</a>
<ul>
<li><a href="part-ii-dimension-reduction-methods.html#a-warning" id="toc-a-warning">A warning</a></li>
</ul></li>
<li><a href="4-pca.html#pca" id="toc-pca"><span class="toc-section-number">4</span> Principal Component Analysis (PCA)</a>
<ul>
<li><a href="4.1-pca-an-informal-introduction.html#pca-an-informal-introduction" id="toc-pca-an-informal-introduction"><span class="toc-section-number">4.1</span> PCA: an informal introduction</a>
<ul>
<li><a href="4.1-pca-an-informal-introduction.html#notation-recap" id="toc-notation-recap"><span class="toc-section-number">4.1.1</span> Notation recap</a></li>
<li><a href="4.1-pca-an-informal-introduction.html#first-principal-component" id="toc-first-principal-component"><span class="toc-section-number">4.1.2</span> First principal component</a></li>
<li><a href="4.1-pca-an-informal-introduction.html#second-principal-component" id="toc-second-principal-component"><span class="toc-section-number">4.1.3</span> Second principal component</a></li>
<li><a href="4.1-pca-an-informal-introduction.html#geometric-interpretation-1" id="toc-geometric-interpretation-1"><span class="toc-section-number">4.1.4</span> Geometric interpretation</a></li>
<li><a href="4.1-pca-an-informal-introduction.html#example" id="toc-example"><span class="toc-section-number">4.1.5</span> Example</a></li>
<li><a href="4.1-pca-an-informal-introduction.html#example-iris" id="toc-example-iris"><span class="toc-section-number">4.1.6</span> Example: Iris</a></li>
</ul></li>
<li><a href="4.2-pca-a-formal-description-with-proofs.html#pca-a-formal-description-with-proofs" id="toc-pca-a-formal-description-with-proofs"><span class="toc-section-number">4.2</span> PCA: a formal description with proofs</a>
<ul>
<li><a href="4.2-pca-a-formal-description-with-proofs.html#properties-of-principal-components" id="toc-properties-of-principal-components"><span class="toc-section-number">4.2.1</span> Properties of principal components</a></li>
<li><a href="4.2-pca-a-formal-description-with-proofs.html#pca:football" id="toc-pca:football"><span class="toc-section-number">4.2.2</span> Example: Football</a></li>
<li><a href="4.2-pca-a-formal-description-with-proofs.html#pcawithR" id="toc-pcawithR"><span class="toc-section-number">4.2.3</span> PCA based on <span class="math inline">\(\mathbf R\)</span> versus PCA based on <span class="math inline">\(\mathbf S\)</span></a></li>
<li><a href="4.2-pca-a-formal-description-with-proofs.html#population-pca" id="toc-population-pca"><span class="toc-section-number">4.2.4</span> Population PCA</a></li>
<li><a href="4.2-pca-a-formal-description-with-proofs.html#pca-under-transformations-of-variables" id="toc-pca-under-transformations-of-variables"><span class="toc-section-number">4.2.5</span> PCA under transformations of variables</a></li>
</ul></li>
<li><a href="4.3-an-alternative-view-of-pca.html#an-alternative-view-of-pca" id="toc-an-alternative-view-of-pca"><span class="toc-section-number">4.3</span> An alternative view of PCA</a>
<ul>
<li><a href="4.3-an-alternative-view-of-pca.html#pca-mnist" id="toc-pca-mnist"><span class="toc-section-number">4.3.1</span> Example: MNIST handwritten digits</a></li>
</ul></li>
<li><a href="4.4-pca-comptask.html#pca-comptask" id="toc-pca-comptask"><span class="toc-section-number">4.4</span> Computer tasks</a></li>
<li><a href="4.5-exercises-1.html#exercises-1" id="toc-exercises-1"><span class="toc-section-number">4.5</span> Exercises</a></li>
</ul></li>
<li><a href="5-cca.html#cca" id="toc-cca"><span class="toc-section-number">5</span> Canonical Correlation Analysis (CCA)</a>
<ul>
<li><a href="5.1-cca1.html#cca1" id="toc-cca1"><span class="toc-section-number">5.1</span> The first pair of canonical variables</a>
<ul>
<li><a href="5.1-cca1.html#the-first-canonical-components" id="toc-the-first-canonical-components"><span class="toc-section-number">5.1.1</span> The first canonical components</a></li>
<li><a href="5.1-cca1.html#premcca" id="toc-premcca"><span class="toc-section-number">5.1.2</span> Example: Premier league football</a></li>
</ul></li>
<li><a href="5.2-the-full-set-of-canonical-correlations.html#the-full-set-of-canonical-correlations" id="toc-the-full-set-of-canonical-correlations"><span class="toc-section-number">5.2</span> The full set of canonical correlations</a>
<ul>
<li><a href="5.2-the-full-set-of-canonical-correlations.html#example-continued" id="toc-example-continued"><span class="toc-section-number">5.2.1</span> Example continued</a></li>
</ul></li>
<li><a href="5.3-properties.html#properties" id="toc-properties"><span class="toc-section-number">5.3</span> Properties</a>
<ul>
<li><a href="5.3-properties.html#connection-with-linear-regression-when-q1" id="toc-connection-with-linear-regression-when-q1"><span class="toc-section-number">5.3.1</span> Connection with linear regression when <span class="math inline">\(q=1\)</span></a></li>
<li><a href="5.3-properties.html#invarianceequivariance-properties-of-cca" id="toc-invarianceequivariance-properties-of-cca"><span class="toc-section-number">5.3.2</span> Invariance/equivariance properties of CCA</a></li>
</ul></li>
<li><a href="5.4-computer-tasks-1.html#computer-tasks-1" id="toc-computer-tasks-1"><span class="toc-section-number">5.4</span> Computer tasks</a></li>
<li><a href="5.5-exercises-2.html#exercises-2" id="toc-exercises-2"><span class="toc-section-number">5.5</span> Exercises</a></li>
</ul></li>
<li><a href="6-mds.html#mds" id="toc-mds"><span class="toc-section-number">6</span> Multidimensional Scaling (MDS)</a>
<ul>
<li><a href="6.1-classical-mds.html#classical-mds" id="toc-classical-mds"><span class="toc-section-number">6.1</span> Classical MDS</a>
<ul>
<li><a href="6.1-classical-mds.html#non-euclidean-distance-matrices" id="toc-non-euclidean-distance-matrices"><span class="toc-section-number">6.1.1</span> Non-Euclidean distance matrices</a></li>
<li><a href="6.1-classical-mds.html#principal-coordinate-analysis" id="toc-principal-coordinate-analysis"><span class="toc-section-number">6.1.2</span> Principal Coordinate Analysis</a></li>
</ul></li>
<li><a href="6.2-similarity.html#similarity" id="toc-similarity"><span class="toc-section-number">6.2</span> Similarity measures</a>
<ul>
<li><a href="6.2-similarity.html#binary-attributes" id="toc-binary-attributes"><span class="toc-section-number">6.2.1</span> Binary attributes</a></li>
<li><a href="6.2-similarity.html#example-classical-mds-with-the-mnist-data" id="toc-example-classical-mds-with-the-mnist-data"><span class="toc-section-number">6.2.2</span> Example: Classical MDS with the MNIST data</a></li>
</ul></li>
<li><a href="6.3-non-metric-mds.html#non-metric-mds" id="toc-non-metric-mds"><span class="toc-section-number">6.3</span> Non-metric MDS</a></li>
<li><a href="6.4-exercises-3.html#exercises-3" id="toc-exercises-3"><span class="toc-section-number">6.4</span> Exercises</a></li>
<li><a href="6.5-computer-tasks-2.html#computer-tasks-2" id="toc-computer-tasks-2"><span class="toc-section-number">6.5</span> Computer Tasks</a></li>
</ul></li>
<li><a href="part-iii-inference-using-the-multivariate-normal-distribution-mvn.html#part-iii-inference-using-the-multivariate-normal-distribution-mvn" id="toc-part-iii-inference-using-the-multivariate-normal-distribution-mvn">Part III: Inference using the Multivariate Normal Distribution (MVN)</a></li>
<li><a href="7-multinormal.html#multinormal" id="toc-multinormal"><span class="toc-section-number">7</span> The Multivariate Normal Distribution</a>
<ul>
<li><a href="7.1-definition-and-properties-of-the-mvn.html#definition-and-properties-of-the-mvn" id="toc-definition-and-properties-of-the-mvn"><span class="toc-section-number">7.1</span> Definition and Properties of the MVN</a>
<ul>
<li><a href="7.1-definition-and-properties-of-the-mvn.html#basics" id="toc-basics"><span class="toc-section-number">7.1.1</span> Basics</a></li>
<li><a href="7.1-definition-and-properties-of-the-mvn.html#transformations" id="toc-transformations"><span class="toc-section-number">7.1.2</span> Transformations</a></li>
<li><a href="7.1-definition-and-properties-of-the-mvn.html#independence" id="toc-independence"><span class="toc-section-number">7.1.3</span> Independence</a></li>
<li><a href="7.1-definition-and-properties-of-the-mvn.html#confidence-ellipses" id="toc-confidence-ellipses"><span class="toc-section-number">7.1.4</span> Confidence ellipses</a></li>
<li><a href="7.1-definition-and-properties-of-the-mvn.html#sampling-results-for-the-mvn" id="toc-sampling-results-for-the-mvn"><span class="toc-section-number">7.1.5</span> Sampling results for the MVN</a></li>
</ul></li>
<li><a href="7.2-the-wishart-distribution.html#the-wishart-distribution" id="toc-the-wishart-distribution"><span class="toc-section-number">7.2</span> The Wishart distribution</a>
<ul>
<li><a href="7.2-the-wishart-distribution.html#properties-1" id="toc-properties-1"><span class="toc-section-number">7.2.1</span> Properties</a></li>
<li><a href="7.2-the-wishart-distribution.html#cochrans-theorem" id="toc-cochrans-theorem"><span class="toc-section-number">7.2.2</span> Cochran’s theorem</a></li>
</ul></li>
<li><a href="7.3-hotellings-t2-distribution.html#hotellings-t2-distribution" id="toc-hotellings-t2-distribution"><span class="toc-section-number">7.3</span> Hotelling’s <span class="math inline">\(T^2\)</span> distribution</a></li>
<li><a href="7.4-inference-based-on-the-mvn.html#inference-based-on-the-mvn" id="toc-inference-based-on-the-mvn"><span class="toc-section-number">7.4</span> Inference based on the MVN</a>
<ul>
<li><a href="7.4-inference-based-on-the-mvn.html#onesampleSigma" id="toc-onesampleSigma"><span class="toc-section-number">7.4.1</span> <span class="math inline">\(\boldsymbol{\Sigma}\)</span> known</a></li>
<li><a href="7.4-inference-based-on-the-mvn.html#onesample" id="toc-onesample"><span class="toc-section-number">7.4.2</span> <span class="math inline">\(\boldsymbol{\Sigma}\)</span> unknown: 1 sample</a></li>
<li><a href="7.4-inference-based-on-the-mvn.html#boldsymbolsigma-unknown-2-samples" id="toc-boldsymbolsigma-unknown-2-samples"><span class="toc-section-number">7.4.3</span> <span class="math inline">\(\boldsymbol{\Sigma}\)</span> unknown: 2 samples</a></li>
</ul></li>
<li><a href="7.5-exercises-4.html#exercises-4" id="toc-exercises-4"><span class="toc-section-number">7.5</span> Exercises</a></li>
<li><a href="7.6-computer-tasks-3.html#computer-tasks-3" id="toc-computer-tasks-3"><span class="toc-section-number">7.6</span> Computer tasks</a></li>
</ul></li>
<li><a href="part-iv-classification-and-clustering.html#part-iv-classification-and-clustering" id="toc-part-iv-classification-and-clustering">Part IV: Classification and Clustering</a></li>
<li><a href="8-lda.html#lda" id="toc-lda"><span class="toc-section-number">8</span> Discriminant analysis</a>
<ul>
<li><a href="8-lda.html#linear-discriminant-analysis" id="toc-linear-discriminant-analysis">Linear discriminant analysis</a></li>
<li><a href="8.1-lda-ML.html#lda-ML" id="toc-lda-ML"><span class="toc-section-number">8.1</span> Maximum likelihood (ML) discriminant rule</a>
<ul>
<li><a href="8.1-lda-ML.html#multivariate-normal-populations" id="toc-multivariate-normal-populations"><span class="toc-section-number">8.1.1</span> Multivariate normal populations</a></li>
<li><a href="8.1-lda-ML.html#sample-lda" id="toc-sample-lda"><span class="toc-section-number">8.1.2</span> The sample ML discriminant rule</a></li>
<li><a href="8.1-lda-ML.html#two-populations" id="toc-two-populations"><span class="toc-section-number">8.1.3</span> Two populations</a></li>
<li><a href="8.1-lda-ML.html#more-than-two-populations" id="toc-more-than-two-populations"><span class="toc-section-number">8.1.4</span> More than two populations</a></li>
</ul></li>
<li><a href="8.2-lda-Bayes.html#lda-Bayes" id="toc-lda-Bayes"><span class="toc-section-number">8.2</span> Bayes discriminant rule</a>
<ul>
<li><a href="8.2-lda-Bayes.html#example-lda-using-the-iris-data" id="toc-example-lda-using-the-iris-data"><span class="toc-section-number">8.2.1</span> Example: LDA using the Iris data</a></li>
<li><a href="8.2-lda-Bayes.html#quadratic-discriminant-analysis-qda" id="toc-quadratic-discriminant-analysis-qda"><span class="toc-section-number">8.2.2</span> Quadratic Discriminant Analysis (QDA)</a></li>
<li><a href="8.2-lda-Bayes.html#prediction-accuracy" id="toc-prediction-accuracy"><span class="toc-section-number">8.2.3</span> Prediction accuracy</a></li>
</ul></li>
<li><a href="8.3-FLDA.html#FLDA" id="toc-FLDA"><span class="toc-section-number">8.3</span> Fisher’s linear discriminant rule</a>
<ul>
<li><a href="8.3-FLDA.html#iris-example-continued-1" id="toc-iris-example-continued-1"><span class="toc-section-number">8.3.1</span> Iris example continued</a></li>
<li><a href="8.3-FLDA.html#links-between-methods" id="toc-links-between-methods"><span class="toc-section-number">8.3.2</span> Links between methods</a></li>
</ul></li>
<li><a href="8.4-computer-tasks-4.html#computer-tasks-4" id="toc-computer-tasks-4"><span class="toc-section-number">8.4</span> Computer tasks</a></li>
<li><a href="8.5-exercises-5.html#exercises-5" id="toc-exercises-5"><span class="toc-section-number">8.5</span> Exercises</a></li>
</ul></li>
<li><a href="9-cluster.html#cluster" id="toc-cluster"><span class="toc-section-number">9</span> Cluster Analysis</a>
<ul>
<li><a href="9.1-k-means-clustering.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">9.1</span> K-means clustering</a>
<ul>
<li><a href="9.1-k-means-clustering.html#estimating-boldsymbol-delta" id="toc-estimating-boldsymbol-delta"><span class="toc-section-number">9.1.1</span> Estimating <span class="math inline">\(\boldsymbol \delta\)</span></a></li>
<li><a href="9.1-k-means-clustering.html#k-means" id="toc-k-means"><span class="toc-section-number">9.1.2</span> K-means</a></li>
<li><a href="9.1-k-means-clustering.html#example-iris-data" id="toc-example-iris-data"><span class="toc-section-number">9.1.3</span> Example: Iris data</a></li>
<li><a href="9.1-k-means-clustering.html#choosing-k" id="toc-choosing-k"><span class="toc-section-number">9.1.4</span> Choosing <span class="math inline">\(K\)</span></a></li>
</ul></li>
<li><a href="9.2-model-based-clustering.html#model-based-clustering" id="toc-model-based-clustering"><span class="toc-section-number">9.2</span> Model-based clustering</a>
<ul>
<li><a href="9.2-model-based-clustering.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">9.2.1</span> Maximum-likelihood estimation</a></li>
<li><a href="9.2-model-based-clustering.html#multivariate-gaussian-clusters" id="toc-multivariate-gaussian-clusters"><span class="toc-section-number">9.2.2</span> Multivariate Gaussian clusters</a></li>
<li><a href="9.2-model-based-clustering.html#example-iris-1" id="toc-example-iris-1"><span class="toc-section-number">9.2.3</span> Example: Iris</a></li>
</ul></li>
<li><a href="9.3-hierarchical-clustering-methods.html#hierarchical-clustering-methods" id="toc-hierarchical-clustering-methods"><span class="toc-section-number">9.3</span> Hierarchical clustering methods</a>
<ul>
<li><a href="9.3-hierarchical-clustering-methods.html#distance-measures" id="toc-distance-measures"><span class="toc-section-number">9.3.1</span> Distance measures</a></li>
<li><a href="9.3-hierarchical-clustering-methods.html#toy-example" id="toc-toy-example"><span class="toc-section-number">9.3.2</span> Toy Example</a></li>
<li><a href="9.3-hierarchical-clustering-methods.html#comparison-of-methods" id="toc-comparison-of-methods"><span class="toc-section-number">9.3.3</span> Comparison of methods</a></li>
</ul></li>
<li><a href="9.4-summary.html#summary" id="toc-summary"><span class="toc-section-number">9.4</span> Summary</a></li>
<li><a href="9.5-computer-tasks-5.html#computer-tasks-5" id="toc-computer-tasks-5"><span class="toc-section-number">9.5</span> Computer tasks</a></li>
<li><a href="9.6-exercises-6.html#exercises-6" id="toc-exercises-6"><span class="toc-section-number">9.6</span> Exercises</a></li>
</ul></li>
<li><a href="10-lm.html#lm" id="toc-lm"><span class="toc-section-number">10</span> Linear Models</a>
<ul>
<li><a href="10-lm.html#notation-3" id="toc-notation-3">Notation</a></li>
<li><a href="10.1-ordinary-least-squares-ols.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">10.1</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="10.1-ordinary-least-squares-ols.html#geometry" id="toc-geometry"><span class="toc-section-number">10.1.1</span> Geometry</a></li>
<li><a href="10.1-ordinary-least-squares-ols.html#normal-linear-model" id="toc-normal-linear-model"><span class="toc-section-number">10.1.2</span> Normal linear model</a></li>
<li><a href="10.1-ordinary-least-squares-ols.html#linear-models-in-r" id="toc-linear-models-in-r"><span class="toc-section-number">10.1.3</span> Linear models in R</a></li>
<li><a href="10.1-ordinary-least-squares-ols.html#problems-with-ols" id="toc-problems-with-ols"><span class="toc-section-number">10.1.4</span> Problems with OLS</a></li>
</ul></li>
<li><a href="10.2-principal-component-regression-pcr.html#principal-component-regression-pcr" id="toc-principal-component-regression-pcr"><span class="toc-section-number">10.2</span> Principal component regression (PCR)</a>
<ul>
<li><a href="10.2-principal-component-regression-pcr.html#pcr-in-r" id="toc-pcr-in-r"><span class="toc-section-number">10.2.1</span> PCR in R</a></li>
</ul></li>
<li><a href="10.3-shrinkage-methods.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">10.3</span> Shrinkage methods</a>
<ul>
<li><a href="10.3-shrinkage-methods.html#ridge-regression-in-r" id="toc-ridge-regression-in-r"><span class="toc-section-number">10.3.1</span> Ridge regression in R</a></li>
</ul></li>
<li><a href="10.4-multi-output-linear-model.html#multi-output-linear-model" id="toc-multi-output-linear-model"><span class="toc-section-number">10.4</span> Multi-output Linear Model</a>
<ul>
<li><a href="10.4-multi-output-linear-model.html#normal-linear-model-1" id="toc-normal-linear-model-1"><span class="toc-section-number">10.4.1</span> Normal linear model</a></li>
<li><a href="10.4-multi-output-linear-model.html#reduced-rank-regression" id="toc-reduced-rank-regression"><span class="toc-section-number">10.4.2</span> Reduced rank regression</a></li>
</ul></li>
<li><a href="10.5-computer-tasks-6.html#computer-tasks-6" id="toc-computer-tasks-6"><span class="toc-section-number">10.5</span> Computer tasks</a></li>
<li><a href="10.6-exercises-7.html#exercises-7" id="toc-exercises-7"><span class="toc-section-number">10.6</span> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li> <a href="https://rich-d-wilkinson.github.io/teaching.html" target="blank">University of Nottingham</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linalg-innerprod" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Inner product spaces</h2>
<div id="normed" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Distances, and angles</h3>
<p>Vector spaces are not particularly interesting from a statistical point of view until we equip them with a sense of geometry, i.e. distance and angle.</p>

<div class="definition">
<span id="def:innerprod" class="definition"><strong>Definition 2.8  </strong></span>A real <strong>inner product space</strong> <span class="math inline">\((V, \langle\cdot,\cdot\rangle)\)</span> is a real vector space <span class="math inline">\(V\)</span> equipped with a map
<span class="math display">\[ \langle\cdot,\cdot\rangle : V \times V \rightarrow \mathbb{R}\]</span>
such that
</div>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\langle\cdot,\cdot\rangle\)</span> is a linear map in both arguments:
<span class="math display">\[\langle \alpha \mathbf v_1+\beta \mathbf v_2, \mathbf u\rangle = \alpha \langle \mathbf v_1, \mathbf u\rangle + \beta \langle \mathbf v_2, \mathbf u\rangle\]</span>
for all <span class="math inline">\(\mathbf v_1, \mathbf v_2, \mathbf u\in V\)</span> and <span class="math inline">\(\alpha, \beta \in \mathbb{R}\)</span>.</li>
<li><span class="math inline">\(\langle\cdot,\cdot\rangle\)</span> is symmetric in its arguments: <span class="math inline">\(\langle \mathbf v, \mathbf u\rangle = \langle \mathbf u, \mathbf v\rangle\)</span> for all <span class="math inline">\(\mathbf u,\mathbf v\in V\)</span></li>
<li><span class="math inline">\(\langle\cdot,\cdot\rangle\)</span> is positive definite: <span class="math inline">\(\langle \mathbf v, \mathbf v\rangle \geq 0\)</span> for all <span class="math inline">\(\mathbf v\in V\)</span> with equality if and only if <span class="math inline">\(\mathbf v={\mathbf 0}\)</span>.</li>
</ol>
<p>An inner product provides a vector space with the concepts of</p>
<ul>
<li><p><strong>distance</strong>: for all <span class="math inline">\(v\in V\)</span> define the <strong>norm</strong> of <span class="math inline">\(v\)</span> to be <span class="math display">\[||\mathbf v|| = \langle \mathbf v, \mathbf v\rangle ^{\frac{1}{2}}\]</span>
Thus any inner-product space <span class="math inline">\((V, \langle\cdot,\cdot\rangle)\)</span> is also a normed space <span class="math inline">\((V, ||\cdot||)\)</span>, and a metric space <span class="math inline">\((V, d(\mathbf x,\mathbf y)=||\mathbf x-\mathbf y||)\)</span>.</p></li>
<li><p><strong>angle</strong>: for <span class="math inline">\(\mathbf u, \mathbf v\in V\)</span> we define the angle between <span class="math inline">\(\mathbf u\)</span> and <span class="math inline">\(\mathbf v\)</span> to be <span class="math inline">\(\theta\)</span> where
<span class="math display">\[\begin{align*}
\langle \mathbf u,\mathbf v\rangle &amp;= ||\mathbf u||.||\mathbf v||\cos \theta\\
\implies \theta &amp;= \cos^{-1}\left( \frac{\langle \mathbf u, \mathbf v\rangle}{||\mathbf u|| \;||\mathbf v||}\right)
\end{align*}\]</span>
We will primarily be interested in the concept of <strong>orthogonality</strong>. We say <span class="math inline">\(\mathbf u, \mathbf v\in V\)</span> are orthogonal if
<span class="math display">\[\langle \mathbf u, \mathbf v\rangle =0\]</span>
i.e., the <em>angle</em> between them is <span class="math inline">\(\frac{\pi}{2}\)</span>.</p></li>
</ul>
<p>If you have done any functional analysis, you may recall that a Hilbert space is a <em>complete</em> inner-product space, and a Banach space is a complete normed space. This is an applied module, so we will skirt much of the technical detail, but note that some of the proofs formally require us to be working in a Banach or Hilbert space. We will not concern ourselves with such detail.</p>

<div class="example">
<p><span id="exm:Rp3" class="example"><strong>Example 2.11  </strong></span>We will mostly be working with the Euclidean vector spaces <span class="math inline">\(V=\mathbb{R}^n\)</span>, in which we use the <em>Euclidean</em> inner product
<span class="math display">\[\langle \mathbf u, \mathbf v\rangle = \mathbf u^\top \mathbf v\]</span>
sometimes called the <strong>scalar</strong> or <strong>dot product</strong> of <span class="math inline">\(\mathbf u\)</span> and <span class="math inline">\(\mathbf v\)</span>. Sometimes this gets weighted by a matrix so that
<span class="math display">\[\langle \mathbf u, \mathbf v\rangle_Q = \mathbf u^\top \mathbf Q\mathbf v.\]</span></p>
<p>The norm associated with the dot product is the square root of the sum of squared errors, denoted by <span class="math inline">\(|| \cdot ||_2\)</span>.
The <strong>length</strong> of <span class="math inline">\(\mathbf u\)</span> is then
<span class="math display">\[||\mathbf u||_2=\sqrt{\mathbf u^\top \mathbf u} =\left( \sum_{i=1}^n u_i^2\right)^\frac{1}{2}\geq 0.\]</span>
Note that <span class="math inline">\(||\mathbf u||_2=0\)</span> if and only if <span class="math inline">\(\mathbf u={\mathbf 0}_n\)</span> where <span class="math inline">\(\stackrel{n\times 1}{\mathbf 0}_n=(0,0,\dots ,0)^\top\)</span>.</p>
We say <span class="math inline">\(\mathbf u\)</span> is orthogonal to <span class="math inline">\(\mathbf v\)</span> if <span class="math inline">\(\mathbf u^\top \mathbf v=0\)</span>.
For example, if
<span class="math display">\[\mathbf u=\left(\begin{array}{c}1\\2\end{array}\right) \mbox{ and } \mathbf v=\left(\begin{array}{c}-2\\1\end{array}\right)\]</span>
then
<span class="math display">\[||\mathbf u||_2 = \sqrt{5}\mbox{ and } \mathbf u^\top \mathbf v=0.\]</span>
We will write <span class="math inline">\(\mathbf u\perp \mathbf v\)</span> if <span class="math inline">\(\mathbf u\)</span> is orthogonal to <span class="math inline">\(\mathbf v\)</span>.
</div>

<div class="definition">
<span id="def:pnorms" class="definition"><strong>Definition 2.9  </strong></span><strong>p-norm:</strong> The subscript <span class="math inline">\(2\)</span> hints at a wider family of norms. We define the <span class="math inline">\(L_p\)</span> norm to be
<span class="math display">\[|| \mathbf v||_p = \left(\sum_{i=1}^n |v_i|^p\right)^\frac{1}{p}.\]</span>
</div>
<!-- OKAY TO HERE-->
</div>
<div id="orthogonal-matrices" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Orthogonal matrices</h3>

<div class="definition">
<p><span id="def:orthogonal" class="definition"><strong>Definition 2.10  </strong></span>A <strong>unit vector</strong> <span class="math inline">\(\mathbf v\)</span> is a vector satisfying <span class="math inline">\(||{\mathbf v}||=1\)</span>, i.e., it is a vector of length <span class="math inline">\(1\)</span>. Vectors <span class="math inline">\(\mathbf u\)</span> and <span class="math inline">\(\mathbf v\)</span> are orthonormal if
<span class="math display">\[||\mathbf u||=||\mathbf v|| = 1 \mbox{ and } \langle \mathbf u, \mathbf v\rangle =0.\]</span></p>
<p>An <span class="math inline">\(n\times n\)</span> matrix <span class="math inline">\({\mathbf Q}\)</span> is an <strong>orthogonal matrix</strong> if <span class="math display">\[{\mathbf Q}\mathbf Q^\top = {\mathbf Q}^\top {\mathbf Q}={\mathbf I}_n.\]</span></p>
<p>Equivalently, a matrix <span class="math inline">\(\mathbf Q\)</span> is orthogonal if <span class="math inline">\({\mathbf Q}^{-1}={\mathbf Q}^\top.\)</span></p>
If <span class="math inline">\({\mathbf Q}=[\mathbf q_1,\ldots, \mathbf q_n]\)</span> is an orthogonal matrix, then the columns <span class="math inline">\(\mathbf q_1, \ldots, \mathbf q_n\)</span> are mutually <strong>orthonormal</strong> vectors, i.e.
<span class="math display">\[
\mathbf q_j^\top \mathbf q_k=\begin{cases} 1 &amp;\hbox{ if }  j=k\\
0 &amp;\hbox{ if }   j \neq k. \\
\end{cases}
\]</span>
</div>
<p><br></p>

<div class="lemma">
<span id="lem:lemorthog" class="lemma"><strong>Lemma 2.2  </strong></span>Let <span class="math inline">\(\mathbf Q\)</span> be a <span class="math inline">\(n\times p\)</span> matrix and suppose <span class="math inline">\(\mathbf Q^\top \mathbf Q=\mathbf I_p\)</span>, where <span class="math inline">\(\mathbf I_p\)</span> is the <span class="math inline">\(p \times p\)</span> identity matrix. If <span class="math inline">\(\mathbf Q\)</span> is a square matrix (<span class="math inline">\(n=p\)</span>), then <span class="math inline">\(\mathbf Q\mathbf Q^\top = \mathbf I_p\)</span>. If <span class="math inline">\(\mathbf Q\)</span> is not square (<span class="math inline">\(n\not =p\)</span>), then <span class="math inline">\(\mathbf Q\mathbf Q^\top \not = I_n\)</span>.
</div>
<div class="proof">
<p><span id="unlabeled-div-2" class="proof"><em>Proof</em>. </span>Suppose <span class="math inline">\(n=p\)</span>, and think of <span class="math inline">\(\mathbf Q\)</span> as a linear map
<span class="math display">\[\begin{align*}
\mathbf Q: &amp;\mathbb{R}^n \rightarrow \mathbb{R}^n\\
&amp;\mathbf v\mapsto \mathbf Q\mathbf v
\end{align*}\]</span>
By the rank-nullity theorem,
<span class="math display">\[\dim \operatorname{Ker}(\mathbf Q) + \dim \operatorname{Im}(\mathbf Q) =n\]</span>
and because <span class="math inline">\(\mathbf Q\)</span> has a left-inverse, we must have <span class="math inline">\(\dim \operatorname{Ker}(\mathbf Q)=0\)</span>, as otherwise <span class="math inline">\(\mathbf Q^\top\)</span> would have to map from a vector space of dimension less than <span class="math inline">\(n\)</span> to <span class="math inline">\(\mathbb{R}^n\)</span>. So <span class="math inline">\(\mathbf Q\)</span> is of full rank, and thus must also have a right inverse, <span class="math inline">\(\mathbf B\)</span> say, with <span class="math inline">\(\mathbf Q\mathbf B=\mathbf I_n\)</span>. If we left multiply by <span class="math inline">\(\mathbf Q^\top\)</span> we get
<span class="math display">\[\begin{align*}
\mathbf Q\mathbf B&amp;=\mathbf I_n\\
\mathbf Q^\top\mathbf Q\mathbf B&amp;=\mathbf Q^\top\\
\mathbf I_n \mathbf B&amp;= \mathbf Q^\top\\
\mathbf B&amp;= \mathbf Q^\top\\
\end{align*}\]</span>
and so we have that <span class="math inline">\(\mathbf Q^{-1}=\mathbf Q^\top\)</span>.</p>
<p>Now suppose <span class="math inline">\(\mathbf Q\)</span> is <span class="math inline">\(n \times p\)</span> with <span class="math inline">\(n\not = p\)</span>. Then as
<span class="math inline">\(\mathbf Q^\top \mathbf Q=\mathbf I_{p\times p}\)</span>, we must have <span class="math inline">\(\operatorname{tr}(\mathbf Q^\top \mathbf Q)=p\)</span>. This implies that
<span class="math display">\[\operatorname{tr}(\mathbf Q\mathbf Q^\top)=\operatorname{tr}(\mathbf Q^\top \mathbf Q)=m\]</span> and so
we cannot have <span class="math inline">\(\mathbf Q\mathbf Q^\top=\mathbf I_{n}\)</span> as <span class="math inline">\(\operatorname{tr}{\mathbf I_{n}}=n\)</span>.</p>
</div>
<p><br></p>

<div class="corollary">
<span id="cor:two1" class="corollary"><strong>Corollary 2.2  </strong></span>If <span class="math inline">\(\mathbf q_1, \ldots , \mathbf q_n\)</span> are mutually orthogonal <span class="math inline">\(n \times 1\)</span> unit vectors then
<span class="math display">\[
\sum_{i=1}^n \mathbf q_i \mathbf q_i^\top = {\mathbf I}_n.
\]</span>
</div>
<div class="proof">
<p><span id="unlabeled-div-3" class="proof"><em>Proof</em>. </span>Let <span class="math inline">\(\mathbf Q\)</span> be the matrix with <span class="math inline">\(i^{th}\)</span> column <span class="math inline">\(\mathbf q_i\)</span>
<span class="math display">\[\mathbf Q=\left(
    \begin{array}{ccc}
    | &amp;&amp;|\\
    \mathbf q_1&amp; \ldots&amp; \mathbf q_n\\
    | &amp;&amp;|
      \end{array}\right).\]</span>
Then <span class="math inline">\(\mathbf Q^\top \mathbf Q=\mathbf I_n\)</span>, and <span class="math inline">\(\mathbf Q\)</span> is <span class="math inline">\(n\times n\)</span>. Thus by Lemma <a href="2.3-linalg-innerprod.html#lem:lemorthog">2.2</a>, we must also have <span class="math inline">\(\mathbf Q\mathbf Q^\top=\mathbf I_n\)</span> and if we think about matrix-matrix multiplication as columns times rows (c.f. section <a href="3.1-matrix-matrix.html#matrix-matrix">3.1</a>), we get
<span class="math display">\[\mathbf I_n=\mathbf Q\mathbf Q^\top=\left(
    \begin{array}{ccc}
    | &amp;&amp;|\\
    \mathbf q_1&amp; \ldots&amp; \mathbf q_n\\
    | &amp;&amp;|
      \end{array}\right) \left(
    \begin{array}{ccc}
    - &amp;\mathbf q_1^\top&amp;-\\
    &amp; \vdots&amp; \\
    - &amp;\mathbf q_n^\top&amp;-
      \end{array}\right) = \sum_{i=1}^n \mathbf q_i \mathbf q_i^\top\]</span>
as required.</p>
</div>
<!-- OKAY TO HERE -->
</div>
<div id="projection-matrix" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Projections</h3>

<div class="definition">
<span id="def:projection" class="definition"><strong>Definition 2.11  </strong></span><span class="math inline">\(\stackrel{n \times n}{\mathbf P}\)</span> is a <em>projection</em>
matrix if
<span class="math display">\[\mathbf P^2 =\mathbf P\]</span>
i.e., if it is idempotent.
</div>
<p>View <span class="math inline">\(\mathbf P\)</span> as a map from a vector space <span class="math inline">\(W\)</span> to itself. Let <span class="math inline">\(U=\operatorname{Im}(\mathbf P)\)</span> and <span class="math inline">\(V=\operatorname{Ker}(\mathbf P)\)</span> be the image and kernel of <span class="math inline">\(\mathbf P\)</span>.</p>

<div class="proposition">
<span id="prp:projec1" class="proposition"><strong>Proposition 2.3  </strong></span>We can write <span class="math inline">\(\mathbf w\in W\)</span> as the sum of <span class="math inline">\(\mathbf u\in U\)</span> and <span class="math inline">\(\mathbf v\in V\)</span>.
</div>
<div class="proof">
<p><span id="unlabeled-div-4" class="proof"><em>Proof</em>. </span>Let <span class="math inline">\(\mathbf w\in W\)</span>. Then
<span class="math display">\[\mathbf w= \mathbf I_n \mathbf w=(\mathbf I-\mathbf P)\mathbf w+ \mathbf P\mathbf w\]</span>
Now <span class="math inline">\(\mathbf P\mathbf w\in \operatorname{Im}(\mathbf P)\)</span> and <span class="math inline">\((\mathbf I-\mathbf P)\mathbf w\in \operatorname{Ker}(\mathbf P)\)</span> as
<span class="math display">\[\mathbf P(\mathbf I-\mathbf P)\mathbf w= (\mathbf P-\mathbf P^2)\mathbf w=\boldsymbol 0.\]</span></p>
</div>

<div class="proposition">
<span id="prp:projIP" class="proposition"><strong>Proposition 2.4  </strong></span>If <span class="math inline">\(\stackrel{n \times n}{\mathbf P}\)</span> is a projection matrix then <span class="math inline">\({\mathbf I}_n - \mathbf P\)</span> is also
a projection matrix.
</div>
<p>The kernel and image of <span class="math inline">\(\mathbf I-\mathbf P\)</span> are the image and kernel (respectively) of <span class="math inline">\(\mathbf P\)</span>:
<span class="math display">\[\begin{align*}
\operatorname{Ker}(\mathbf I-\mathbf P) &amp;= U=\operatorname{Im}(\mathbf P)\\
\operatorname{Im}(\mathbf I-\mathbf P) &amp;= V=\operatorname{Ker}(\mathbf P).
\end{align*}\]</span></p>
<!-- OKAY TO HERE -->
<div id="orthogproj" class="section level4" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> Orthogonal projection</h4>
<p>We are mostly interested in <strong>orthogonal</strong> projections.</p>

<div class="definition">
<span id="def:orthogproj" class="definition"><strong>Definition 2.12  </strong></span>If <span class="math inline">\(W\)</span> is an inner product space, and <span class="math inline">\(U\)</span> is a subspace of <span class="math inline">\(W\)</span>, then the orthogonal projection of <span class="math inline">\(\mathbf w\in W\)</span> onto <span class="math inline">\(U\)</span> is the unique vector <span class="math inline">\(\mathbf u\in U\)</span> that minimizes
<span class="math display">\[||\mathbf w-\mathbf u||.\]</span>
</div>
<p>In other words, the orthogonal projection of <span class="math inline">\(\mathbf w\)</span> onto <span class="math inline">\(U\)</span> is the <em>best possible approximation</em> of <span class="math inline">\(\mathbf w\)</span> in <span class="math inline">\(U\)</span>.</p>
<p>As above, we can split <span class="math inline">\(W\)</span> into <span class="math inline">\(U\)</span> and its orthogonal compliment
<span class="math display">\[U^\perp = \{\mathbf x\in W: \langle \mathbf x,\mathbf u\rangle = 0\}\]</span>
i.e., <span class="math inline">\(W=U \oplus U^\perp\)</span> so that any <span class="math inline">\(\mathbf w\in W\)</span> can be uniquely written as
<span class="math inline">\(\mathbf w=\mathbf u+\mathbf v\)</span> with <span class="math inline">\(\mathbf u\in U\)</span> and <span class="math inline">\(\mathbf v\in U^\perp\)</span>. This makes clear why we call <span class="math inline">\(\mathbf u= \arg \min_{\mathbf u\in \mathbf U} ||\mathbf w-\mathbf u||\)</span> the <em>orthogonal</em> projection of <span class="math inline">\(\mathbf w\)</span>, it is because it splits <span class="math inline">\(\mathbf w\)</span> into two orthogonal components: <span class="math inline">\(\mathbf w= \mathbf u+\mathbf v\)</span> with <span class="math inline">\(\langle \mathbf u, \mathbf v\rangle=0\)</span>.</p>

<div class="proposition">
<span id="prp:orthogprojection" class="proposition"><strong>Proposition 2.5  </strong></span>If <span class="math inline">\(\{\mathbf u_1, \ldots, \mathbf u_k\}\)</span> is a basis for <span class="math inline">\(U\)</span>, then the orthogonal projection matrix (i.e., the matrix that projects <span class="math inline">\(\mathbf w\in W\)</span> onto <span class="math inline">\(U\)</span>) is
<span class="math display">\[\mathbf P_U = \mathbf A(\mathbf A^\top \mathbf A)^{-1}\mathbf A^\top\]</span> where
<span class="math inline">\(\mathbf A=[\mathbf u_1\; \ldots\; \mathbf u_k]\)</span> is the matrix with columns given by the basis vectors.
</div>
<!-- OKAY TO HERE-->
<div class="proof">
<p><span id="unlabeled-div-5" class="proof"><em>Proof</em>. </span>We need to find <span class="math inline">\(\mathbf u= \sum \lambda_i \mathbf u_i = \mathbf A\boldsymbol \lambda\)</span> that minimizes <span class="math inline">\(||\mathbf w-\mathbf u||\)</span>.</p>
<p><span class="math display">\[\begin{align*}
||\mathbf w-\mathbf u||^2 &amp;= \langle \mathbf w-\mathbf u, \mathbf w-\mathbf u\rangle\\
&amp;= \mathbf w^\top \mathbf w- 2\mathbf u^\top \mathbf w+ \mathbf u^\top \mathbf u\\
&amp;= \mathbf w^\top \mathbf w-2\boldsymbol \lambda^\top \mathbf A^\top \mathbf w+ \boldsymbol \lambda^\top \mathbf A^\top \mathbf A\boldsymbol \lambda.
\end{align*}\]</span></p>
<p>Differentiating with respect to <span class="math inline">\(\boldsymbol \lambda\)</span> and setting equal to zero gives
<span class="math display">\[\boldsymbol 0=-2 \mathbf A^\top \mathbf w+2 \mathbf A^\top \mathbf A\boldsymbol \lambda\]</span>
and hence
<span class="math display">\[ \boldsymbol \lambda= (\mathbf A^\top \mathbf A)^{-1}\mathbf A^\top \mathbf w.\]</span>
The orthogonal projection of <span class="math inline">\(\mathbf w\)</span> is hence
<span class="math display">\[ \mathbf A\boldsymbol \lambda= \mathbf A(\mathbf A^\top \mathbf A)^{-1}\mathbf A^\top \mathbf w\]</span>
and the projection matrix is
<span class="math display">\[\mathbf P_U = \mathbf A(\mathbf A^\top \mathbf A)^{-1}\mathbf A^\top. \]</span></p>
</div>
<p><strong>Notes:</strong></p>
<ol style="list-style-type: decimal">
<li><p>If <span class="math inline">\(\{\mathbf u_1, \ldots, \mathbf u_k\}\)</span> is an orthonormal basis for <span class="math inline">\(U\)</span> then <span class="math inline">\(\mathbf A^\top \mathbf A= \mathbf I\)</span> and <span class="math inline">\(\mathbf P_U = \mathbf A\mathbf A^\top\)</span>. We can then write
<span class="math display">\[\mathbf P_U\mathbf w= \sum_i (\mathbf u_i^\top \mathbf w) \mathbf u_i\]</span>
and
<span class="math display">\[\mathbf P_U = \sum_{i=1}^k \mathbf u_i\mathbf u_i^\top.\]</span>
Note that if <span class="math inline">\(U=W\)</span> (so that <span class="math inline">\(\mathbf P_U\)</span> is a projection from <span class="math inline">\(W\)</span> onto <span class="math inline">\(W\)</span>, i.e., the identity), then <span class="math inline">\(\mathbf A\)</span> is a square matrix (<span class="math inline">\(n\times n\)</span>) and thus <span class="math inline">\(\mathbf A^\top\mathbf A=\mathbf I_n \implies \mathbf A\mathbf A^\top\)</span> and thus <span class="math inline">\(\mathbf P_U=\mathbf I_n\)</span> as required. The coordinates (with respect to the orthonormal basis <span class="math inline">\(\{\mathbf u_1, \ldots, \mathbf u_k\}\)</span>) of a point <span class="math inline">\(\mathbf w\)</span> projected onto <span class="math inline">\(U\)</span> are <span class="math inline">\(\mathbf A^\top \mathbf w\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbf P_U^2=\mathbf P_U\)</span>, so <span class="math inline">\(\mathbf P_U\)</span> is a projection matrix in the sense of definition <a href="2.3-linalg-innerprod.html#def:projection">2.11</a>.</p></li>
<li><p><span class="math inline">\(\mathbf P_U\)</span> is symmetric (<span class="math inline">\(\mathbf P_U^\top=\mathbf P_U\)</span>). This is true for orthogonal projection matrices, but not in general for projection matrices.</p></li>
</ol>

<div class="example">
<span id="exm:proj2" class="example"><strong>Example 2.12  </strong></span>Consider the vector space <span class="math inline">\(\mathbb{R}^2\)</span> and let <span class="math inline">\(\mathbf u=\frac{1}{\sqrt{2}}\left(\begin{array}{c}1\\1\end{array}\right)\)</span>. The projection of <span class="math inline">\(\mathbf v\in \mathbb{R}^2\)</span> onto <span class="math inline">\(\mathbf u\)</span> is given by <span class="math inline">\((\mathbf v^\top \mathbf u) \mathbf u\)</span>. So for example, if <span class="math inline">\(\mathbf v= (2, \; 1)^\top\)</span>, then its projection onto <span class="math inline">\(\mathbf u\)</span> is
<span class="math display">\[\mathbf P_U \mathbf v= \frac{3}{\sqrt{2}}\left(\begin{array}{c}1\\1\end{array}\right).\]</span>
Alternatively, if we treat <span class="math inline">\(\mathbf u\)</span> as a basis for <span class="math inline">\(U\)</span>, then the coordinate of <span class="math inline">\(\mathbf P_U \mathbf v\)</span> with respect to the basis is <span class="math inline">\(3\)</span>.
To check this, draw a picture!
</div>
<!-- OKAY TO HERE -->
</div>
<div id="ch2linreg" class="section level4" number="2.3.3.2">
<h4><span class="header-section-number">2.3.3.2</span> Geometric interpretation of linear regresssion</h4>
<p>Consider the linear regression model
<span class="math display">\[\mathbf y= \mathbf X\boldsymbol \beta+\mathbf e\]</span>
where <span class="math inline">\(\mathbf y\in\mathbb{R}^n\)</span> is the vector of observations, <span class="math inline">\(\mathbf X\)</span> is the <span class="math inline">\(n\times p\)</span> design matrix, <span class="math inline">\(\boldsymbol \beta\)</span> is the <span class="math inline">\(p\times 1\)</span> vector of parameters that we wish to estimate, and <span class="math inline">\(\mathbf e\)</span> is a <span class="math inline">\(n\times 1\)</span> vector of zero-mean errors.</p>
<p>Least-squares regression tries to find the value of <span class="math inline">\(\boldsymbol \beta\in \mathbb{R}^p\)</span> that minimizes the sum of squared errors, i.e., we try to find <span class="math inline">\(\boldsymbol \beta\)</span> to minimize
<span class="math display">\[||\mathbf y- \mathbf X\boldsymbol \beta||_2^2\]</span></p>
<p>We know that <span class="math inline">\(\mathbf X\boldsymbol \beta\)</span> is in the column space of <span class="math inline">\(\mathbf X\)</span>, and so we can see that linear regression aims to find the <em>orthogonal projection</em> onto <span class="math inline">\(\mathcal{C}(X)\)</span>.
<span class="math display">\[\mathbf P_U\mathbf y=\arg \min_{\mathbf y&#39;: \mathbf y&#39; \in \mathcal{C}(X)} ||\mathbf y-\mathbf y&#39;||_2.\]</span></p>
<p>By Proposition <a href="2.3-linalg-innerprod.html#prp:orthogprojection">2.5</a> this is
<span class="math display">\[\mathbf P_U\mathbf y= \mathbf X(\mathbf X^\top \mathbf X)^{-1}\mathbf X^\top \mathbf y=\hat{\mathbf y}\]</span>
which equals the usual prediction obtained in linear regression (<span class="math inline">\(\hat{\mathbf y}\)</span> are often called the fitted values). We can also see that the choice of <span class="math inline">\(\boldsymbol \beta\)</span> that specifies this point in <span class="math inline">\(\mathcal{C}(X)\)</span> is
<span class="math display">\[\hat{\boldsymbol \beta}=(\mathbf X^\top \mathbf X)^{-1}\mathbf X^\top \mathbf y\]</span>
which is the usual least-squares estimator.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.2-linalg-vecspaces.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.4-centering-matrix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MultivariateStatistics.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"pandoc_args": "--top-level-division=[chapter|part]"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
